(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1:function(e,t,n){"use strict";var a={agents:"agents",conversations:"conversations",messages:"messages",faqCategories:"faqCategories",customBots:"customBots",faqs:"faqs",customFields:"customFields",campaigns:"campaigns"},r={DATABASE_WRITE:"DATABASE_WRITE",DATABASE_UPDATE:"DATABASE_UPDATE",DATABASE_REMOVE:"DATABASE_REMOVE",DATABASE_WRITE_UNDEFINED:"DATABASE_WRITE_UNDEFINED",DATABASE_UPDATE_UNDEFINED:"DATABASE_UPDATE_UNDEFINED",DATABASE_REMOVE_UNDEFINED:"DATABASE_REMOVE_UNDEFINED"},o=n(20),i=n(10),s=n(2),c=n(34),u=n.n(c),d=n(276),l=n.n(d),p=n(341),g=n.n(p),m=n(119),f=n.n(m),h=n(3),v=n.n(h),b=n(40),y=n.n(b),E=n(96),A=n.n(E),O=n(342),S=n.n(O);var I=n(211),T=n.n(I);t.a={reducer:function(){var e,t,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g()(a,function(e){return{byId:{}}}),c=arguments.length>1?arguments[1]:void 0;switch(c.type){case r.DATABASE_WRITE:return e=o,t=c.payload.tableName,n=c.payload.items,Object(s.a)({},e,Object(i.a)({},t,Object(s.a)({},e[t],{byId:Object.assign({},e[t].byId||{},S()(n,"_id"))})));case r.DATABASE_UPDATE:return function(e,t,n,a){var r=v()(e,[t,"byId",n]);return r?Object(s.a)({},e,Object(i.a)({},t,Object(s.a)({},e[t],{byId:Object(s.a)({},e[t].byId,Object(i.a)({},n,f()({},r,a)))}))):e}(o,c.payload.tableName,c.payload.id,c.payload.updates);case r.DATABASE_REMOVE:return function(e,t,n){return Object(s.a)({},e,Object(i.a)({},t,Object(s.a)({},e[t],{byId:A()(e[t].byId,function(e,t){return y()(n,t)})})))}(o,c.payload.tableName,c.payload.ids);default:return o}},tableNames:a,remove:function(e,t){return t?{type:r.DATABASE_REMOVE,payload:{tableName:e,ids:T()(t)}}:{type:r.DATABASE_REMOVE_UNDEFINED}},actionNames:r,write:function(e,t){return t?{type:r.DATABASE_WRITE,payload:{tableName:e,items:T()(t)}}:{type:r.DATABASE_WRITE_UNDEFINED}},update:function(e,t,n){return n?{type:r.DATABASE_UPDATE,payload:{tableName:e,id:t,updates:n}}:{type:r.DATABASE_UPDATE_UNDEFINED}},getTable:function(e,t){return e.db[t]},get:function(e,t){return e.byId[t]},getMany:function(e,t){return l()(t,function(t,n){return[].concat(Object(o.a)(t),[e.byId[n]])},[])},query:function(e,t){return u()(e.byId,t)}}},116:function(e,t,n){"use strict";function a(e,t,n){for(var a,r=t instanceof Array,o=n instanceof Array,i=(e=[].concat(e)).length,s=(t=[].concat(t),(n=[].concat(n)).length);a=0,s--;)for(;n[s]=n[s].split(e[a]).join(r?t[a]||"":t[0]),++a<i;);return o?n:n[0]}n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=function(e){return a(new Array("\xe0","\xe1","\u1ea1","\u1ea3","\xe3","\xe2","\u1ea7","\u1ea5","\u1ead","\u1ea9","\u1eab","\u0103","\u1eb1","\u1eaf","\u1eb7","\u1eb3","\u1eb5","\xe8","\xe9","\u1eb9","\u1ebb","\u1ebd","\xea","\u1ec1","\u1ebf","\u1ec7","\u1ec3","\u1ec5","\xec","\xed","\u1ecb","\u1ec9","\u0129","\xf2","\xf3","\u1ecd","\u1ecf","\xf5","\xf4","\u1ed3","\u1ed1","\u1ed9","\u1ed5","\u1ed7","\u01a1","\u1edd","\u1edb","\u1ee3","\u1edf","\u1ee1","\xf9","\xfa","\u1ee5","\u1ee7","\u0169","\u01b0","\u1eeb","\u1ee9","\u1ef1","\u1eed","\u1eef","\u1ef3","\xfd","\u1ef5","\u1ef7","\u1ef9","\u0111","\xc0","\xc1","\u1ea0","\u1ea2","\xc3","\xc2","\u1ea6","\u1ea4","\u1eac","\u1ea8","\u1eaa","\u0102","\u1eb0","\u1eae","\u1eb6","\u1eb2","\u1eb4","\xc8","\xc9","\u1eb8","\u1eba","\u1ebc","\xca","\u1ec0","\u1ebe","\u1ec6","\u1ec2","\u1ec4","\xcc","\xcd","\u1eca","\u1ec8","\u0128","\xd2","\xd3","\u1ecc","\u1ece","\xd5","\xd4","\u1ed2","\u1ed0","\u1ed8","\u1ed4","\u1ed6","\u01a0","\u1edc","\u1eda","\u1ee2","\u1ede","\u1ee0","\xd9","\xda","\u1ee4","\u1ee6","\u0168","\u01af","\u1eea","\u1ee8","\u1ef0","\u1eec","\u1eee","\u1ef2","\xdd","\u1ef4","\u1ef6","\u1ef8","\u0110"),new Array("a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","e","e","e","e","e","e","e","e","e","e","e","i","i","i","i","i","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","o","u","u","u","u","u","u","u","u","u","u","u","y","y","y","y","y","d","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","A","E","E","E","E","E","E","E","E","E","E","E","I","I","I","I","I","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","O","U","U","U","U","U","U","U","U","U","U","U","Y","Y","Y","Y","Y","D"),e)},o=function(e){var t=r(e).toLowerCase();return t=t.replace(/\s+/g," ").trim()},i=function(e){return a(new Array("&lt;br&gt;","&lt;/br&gt;","&lt;p&gt;","&lt;/p&gt;","&lt;strong&gt;","&lt;/strong&gt;","&lt;b&gt;","&lt;/b&gt;","&lt;i&gt;","&lt;/i&gt;"),new Array("<br>","</br>","<p>","</p>","<strong>","</strong>","<b>","</b>","<i>","</i>"),e.replace(/&#([0-9]{1,3});/gi,function(e,t){var n=parseInt(t,10);return String.fromCharCode(n)}))}},13:function(e,t,n){"use strict";var a=n(223),r=n(148),o=n(15),i=n.n(o),s=n(206),c=n.n(s),u=n(4),d=n(7),l=n(1),p={selectConversation:g,ratingConversation:function(e){return function(t){return d.d.ratingConversation(e).then(function(e){return t(l.a.write(l.a.tableNames.messages,e))})}},feedbackConversation:function(e){return function(t){return d.d.feedbackConversation(e).then(function(e){return t(l.a.write(l.a.tableNames.messages,e))})}},initConversation:function(){return{type:"CONVERSATION_INIT"}},selectConversationByAssignedUUID:function(e){return function(t,n){var a=n(),r=l.a.getTable(a,l.a.tableNames.conversations),o=c()(r.byId),s=i()(o,function(t){return t.conversationAssignedUUID===e});return t(g(s))}}};function g(e){return function(t){var n;t((n={conversation:e},{type:u.b.CONVERSATION_SELECTED,payload:n}))}}var m=n(219),f=n(99);n.d(t,"e",function(){return a.a}),n.d(t,"d",function(){return r.a}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return m.a}),n.d(t,"a",function(){return f.a})},148:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var a=n(40),r=n.n(a),o=n(3),i=n.n(o),s=n(16),c=n.n(s),u=n(1),d=n(42),l=n.n(d),p=n(37),g=n(4),m=n(7),f=n(43),h=n(54),v=n(205),b=["image/jpg","image/png","image/jpeg"],y={sendText:function(e,t,n){return function(a){var r=S(e,[{content:n,contentType:"text/html",fragmentType:1}]);return a({type:g.e.MESSAGE_SENDING,payload:r}),O(a),a(A(e,t,r))}},sendImage:function(e,t,n,a){return function(o){var s,c,u=i()(n,"file.type");r()(b,u)?(s=a,c="image"):(s=i()(n,"file.name"),c="file");var d=S(e,[{content:s,contentType:c,fragmentType:1}]);return o({type:g.e.MESSAGE_SENDING,payload:d}),O(o),m.h.uploadFile(e,n.file).then(function(a){return d.blocks[0]={content:a.url||"".concat(l.a.STATIC_ROOT,"user/file/").concat(a.path),contentType:i()(n,"file.type")||i()(a,"meta.mimeType")||"image",meta:a.meta,fragmentType:1,name:i()(n,"file.name")},o(A(e,t,d))})}},loadMessages:function(e,t){return function(n,a){return n({type:g.b.CONVERSATION_MESSAGE_LOADING,payload:{conversationId:e,lastTimestamp:t}}),m.h.getByConversation(e,t).then(function(a){return n(u.a.write(u.a.tableNames.messages,a)),n({type:g.b.CONVERSATION_MESSAGE_LOADED,payload:{lastTimestamp:t,messages:a,conversationId:e}}),i()(a,"0.timestamps")||t}).catch(function(a){throw n({type:g.b.CONVERSATION_MESSAGE_LOADED_FAILED,payload:{conversationId:e,lastTimestamp:t,error:a}}),a})}},loadClientMessages:function(e){return function(t,n){var a=n(),r=u.a.getTable(a,u.a.tableNames.messages),o=u.a.query(r,{conversationId:e});t({type:g.b.CONVERSATION_MESSAGE_LOADED,payload:{conversationId:e,messages:o}})}},resendFailedMessage:function(e){return function(t){return t({type:"RESEND_FAILED_MESSAGE",payload:{message:e}}),t(A(e.conversationId,null,e))}},sendToSocket:function(e){m.f.sendToServer(e)},markAsRead:function(e){return function(t,n){var a=n(),r=u.a.getTable(a,u.a.tableNames.conversations),o=u.a.get(r,e);if(o&&o.unreadByUser)return o.isClientSide?t(E(e)):void m.d.read(e).then(function(){t(E(e))})}}};function E(e){return function(t,n){var a=n(),r=u.a.getTable(a,u.a.tableNames.messages);t(u.a.update(u.a.tableNames.conversations,e,{unreadByUser:!1}));var o=u.a.query(r,{conversationId:e});t({type:"REMOVE_NOTIFICATION",payload:{conversation:{_id:e},messages:o}})}}function A(e,t,n){return function(a,r){var o=null,i=r(),s=u.a.getTable(i,u.a.tableNames.conversations),c=u.a.get(s,e),d=f.a.isBotInProgress(i,c);return c&&!c.isClientSide?(o=m.h.reply(n),d&&(o=o.then(function(e){return a(h.a.checkMessage(c,n)),e}))):d?o=a(h.a.newConversation(c,n)):(delete n.conversationId,t&&(n.conversationAssignedUUID=t),o=m.h.sendMessage(n).then(function(e){return a({type:g.c.NEW_CONVERSATION,payload:{conversation:e}}),e})),o.catch(function(r){a({type:"MESSAGE_SENT_FAILED",payload:{message:n,conversationId:e,conversationAssignedUUID:t,error:r}})})}}function O(e){setTimeout(function(){Object(v.a)().then(function(t){!t&&Object(v.c)(m.a.getToken())&&(p.a.setItem("".concat(m.a.getToken(),".sw"),JSON.stringify({lastAsk:Date.now()})),e({type:g.a.ASK_PERMISSION_SW}))})},1e3)}function S(e,t){return{blocks:t,socketId:m.f.getSocketId(),conversationId:e,author:m.i.getAuthor(),clientAssignedUUID:c()(),location:m.g.getLocation()}}},153:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return o});var a={APP_LOAD:"APP_LOAD",CONVERSATION_SELECTED:"CONVERSATION_SELECTED",CONVERSATION_MESSAGE_LOADING:"CONVERSATION_MESSAGE_LOADING",CONVERSATION_MESSAGE_LOADED:"CONVERSATION_MESSAGE_LOADED",CONVERSATION_MESSAGE_LOADED_FAILED:"CONVERSATION_MESSAGE_LOADED_FAILED",FAQ_TAB_UNLOAD:"FAQ_TAB_UNLOAD",FAQ_VIEW_DETAIL:"FAQ_VIEW_DETAIL",FAQ_VIEW_DETAIL_UNLOAD:"FAQ_VIEW_DETAIL_UNLOAD",FAQ_LIST_UNLOAD:"FAQ_LIST_UNLOAD",FAQ_CATEGORIES_LOADED:"FAQ_CATEGORIES_LOADED",FAQ_CATEGORY_SELECTED:"FAQ_CATEGORY_SELECTED",FAQ_CATEGORIES_FAQS_LOADED:"FAQ_CATEGORIES_FAQS_LOADED",FAQ_ALL_FAQS_LOADED:"FAQ_ALL_FAQS_LOADED",FAQ_SEARCH_MODE_CHANGE:"FAQ_SEARCH_MODE_CHANGE",FAQ_SEARCH_INPUT_CHANGE:"FAQ_SEARCH_INPUT_CHANGE",FAQ_SEARCH_INPUT_FOCUS:"FAQ_SEARCH_INPUT_FOCUS",FAQ_BACK:"FAQ_BACK",ADMIN_TYPING:"ADMIN_TYPING",ADMIN_TYPING_STOP:"ADMIN_TYPING_STOP",CUSTOM_BOT_SIMULATION_INIT:"CUSTOM_BOT_SIMULATION_INIT"},r=[{regex:"(:\\)|:-\\)|=\\))",emoji:"\ud83d\ude42"},{regex:"(:\\(|:-\\(|=\\()",emoji:"\ud83d\ude41"},{regex:"(:\\||:-\\|)",emoji:"\ud83d\ude10"},{regex:"(:[Dd]|:-[Dd]|=[Dd])",emoji:"\ud83d\ude00"},{regex:"(;\\)|;-\\))",emoji:"\ud83d\ude09"},{regex:"(:\\'\\(|:\\'-\\()",emoji:"\ud83d\ude22"},{regex:"(:[oO]|:-[oO])",emoji:"\ud83d\ude2e"},{regex:"([B8]\\)|[B8]-\\))",emoji:"\ud83d\ude0e"},{regex:"(:[pP]|:-[pP]|=[pP])",emoji:"\ud83d\ude1b"},{regex:"(:[\\\\\\/]|:-[\\\\\\/]|=[\\\\\\/])",emoji:"\ud83d\ude15"},{regex:"(<[3])",emoji:"\u2764\ufe0f"},{regex:"(\\([yY]\\))",emoji:"\ud83d\udc4d"},{regex:"(:\\*|:-\\*)",emoji:"\ud83d\ude18"},{regex:"(-_-)",emoji:"\ud83d\ude11"},{regex:"(\\^_\\^)",emoji:"\ud83d\ude0a"},{regex:"(>:\\()",emoji:"\ud83d\ude20"},{regex:"([Oo0]:\\)|[Oo0]:-\\))",emoji:"\ud83d\ude07"},{regex:"([3]:\\)|[3]:-\\))",emoji:"\ud83d\ude08"},{regex:"(:poop:)",emoji:"\ud83d\udca9"},{regex:'(<\\("\\))',emoji:"\ud83d\udc27"}],o="#02B875"},157:function(e,t,n){"use strict";var a=n(6),r=n(41),o=n(37),i={getToken:function(){var e=r.a.getToken();return a.a.getVisitorToken()||o.a.getItem(e+".visitor.token")},login:function(e,t){return a.a.requests.post("user/auth",{email:e,password:t})},isAuthenticated:function(){return!!i.getToken()},register:function(e){return a.a.requests.post("user",e)},loginGoogle:function(e){return a.a.requests.post("user/auth/google",{token:e.accessToken})}};t.a=i},158:function(e,t,n){"use strict";var a=n(16),r=n.n(a),o={};window.addEventListener("message",function(e){if("oc-query-response"===e.data.method){var t=e.data.response,n=o[t.requestId];n&&("success"===t.status?n.resolve(t.result):n.reject(t.error),delete o[t.requestId])}}),t.a={query:function(e){var t=r()();return new Promise(function(n,a){o[t]={resolve:n,reject:a},window.parent.postMessage({method:"oc-query",request:{requestId:t,payload:e}},"*")})}}},159:function(e,t,n){"use strict";n(367);var a=n(160),r=n.n(a),o=n(97),i=n.n(o),s=n(0),c=n.n(s);t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i()({fontSize:24},e);return c.a.createElement(r.a,{type:"loading",className:"theme-color",style:t,spin:!0})}},17:function(e,t,n){"use strict";var a=n(102),r=(Object(a.a)(),n(76)),o=n(225),i=n(117),s=n.n(i),c=n(1);function u(e){var t=c.a.getTable(e,c.a.tableNames.conversations),n=c.a.query(t,{});return s()(n,["lastMessage.timestamps"],["desc"])}var d=n(19),l=n.n(d),p=n(350),g=n.n(p),m=n(11),f=n.n(m),h=n(95),v=n.n(h),b=n(15),y=n.n(b),E=n(3),A=n.n(E),O=n(351),S=n.n(O),I=n(55),T=n.n(I),_=n(74),C=n(31),N=n.n(C);function D(e,t){for(var n,a,r=new RegExp('<span[^>]*?class="tagProp"[^>]*?>(.*?)</span>',"gm"),o=new RegExp("[\\s\\r\\t\\n]*([a-z0-9\\-_]+)[\\s\\r\\t\\n]*=[\\s\\r\\t\\n]*(['\"])((?:\\\\\\2|(?!\\2).)*)\\2","ig"),i=[];n=r.exec(e);){for(var s={};a=o.exec(n[0]);)s[a[1]]=a[3];i.push(s)}var c=e;return T()(S()(i),function(e){var n=function(e,t,n,a){var r=A()(a,"app"),o=A()(a,"isReal"),i=A()(a,"visitor"),s=A()(a,"creator"),c=A()(a,"customFields",[]),u=y()(v()(_.b,(d=c,l()(d,function(e){return{icon:"/images/field/icon-default.png",title:e.name,field:"customFields."+e.code,type:e.dataType}}))),function(e){return e.field===t});var d;if(!o)return"{{".concat(A()(u,"title"),"|fallback: ").concat(n,"}}");if(t===_.c.NAME)return A()(r,"name");if(t===_.c.AGENT_NAME)return A()(s,"name");if(t===_.c.AGENT_FULLNAME)return A()(s,"name");return function(e,t,n){if("boolean"===e)return 0===t?"Kh\xf4ng":1===t?"C\xf3":n;if("date"===e&&t)return N()(t).format("DD/MM/YYYY");if(!f()(g()(t)))return t;return n}(e,A()(i,t),n)}(e["type-data"],e["field-data"],e["fallback-data"],t);c=function(e,t){var n=t.value,a=t.fieldData,r=new RegExp('<span[^>]*?field-data="'.concat(a,'"[^>]*?>(.*?)</span>'),"gm");return e.replace(r,n)}(c,{fieldData:e["field-data"],value:n})}),c}n.d(t,"d",function(){return r.a}),n.d(t,"p",function(){return r.j}),n.d(t,"j",function(){return r.f}),n.d(t,"e",function(){return r.b}),n.d(t,"f",function(){return r.c}),n.d(t,"n",function(){return r.h}),n.d(t,"o",function(){return r.i}),n.d(t,"i",function(){return r.e}),n.d(t,"m",function(){return r.g}),n.d(t,"h",function(){return r.d}),n.d(t,"b",function(){return o.b}),n.d(t,"a",function(){return o.a}),n.d(t,"c",function(){return o.c}),n.d(t,"l",function(){return o.d}),n.d(t,"g",function(){return u}),n.d(t,"k",function(){return D})},18:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(30),i=n.n(o),s=n(159);function c(e){return r.a.createElement("div",{className:"lazy-spin-wrapper",style:e.style},r.a.createElement(s.a,null))}n.d(t,"f",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return l}),n.d(t,"a",function(){return p}),n.d(t,"j",function(){return g}),n.d(t,"i",function(){return m}),n.d(t,"c",function(){return f}),n.d(t,"e",function(){return h}),n.d(t,"d",function(){return v}),n.d(t,"m",function(){return b}),n.d(t,"l",function(){return y}),n.d(t,"k",function(){return E}),n.d(t,"n",function(){return A}),n.d(t,"b",function(){return O}),n.d(t,"o",function(){return I});var u=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.HeaderContent})},loading:function(){return r.a.createElement(c,{style:{top:100}})}}),d=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.HomeConversation})},loading:function(){return r.a.createElement(c,{style:{top:100}})}}),l=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.HomeFAQ})},loading:function(){return null}}),p=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.Conversation})},loading:function(){return null}}),g=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.MessageList})},loading:function(){return r.a.createElement(c,{style:{top:100}})}}),m=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.InputBox})},loading:function(){return null}}),f=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.FAQ})},loading:function(){return null}}),h=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.FAQList})},loading:function(){return null}}),v=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.FAQDetail})},loading:function(){return null}}),b=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(3)]).then(n.bind(null,991)).then(function(e){return e.PrechatSurvey})},loading:function(){return null}}),y=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6)]).then(n.bind(null,993))},loading:function(){return null}}),E=i()({loader:function(){return n.e(7).then(n.bind(null,989))},loading:function(){return null}}),A=i()({loader:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,996))},loading:function(){return null}}),O=i()({loader:function(){return Promise.all([n.e(0),n.e(1),n.e(10)]).then(n.t.bind(null,990,7))},loading:function(){return null}}),S={Conversation:p},I=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(e){var t=S[e];t&&t.preload()})}},205:function(e,t,n){"use strict";var a=n(97),r=n.n(a),o=n(6),i={register:function(e){return o.a.requests.post("/livechat/sw/register",e)},removeRegister:function(e,t){return o.a.setToken(e),o.a.requests.post("/livechat/sw/remove_register",t)},checkRegistered:function(){return o.a.requests.get("/livechat/sw/check")}};var s=n(7),c=n(37);n.d(t,"d",function(){return p}),n.d(t,"e",function(){return g}),n.d(t,"b",function(){return m}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return h});var u="BNe6BHtUTsWGwnRFxDRXkeK4CAPMVaxzjB8ORBh09dObQlDX389VrKNYcpGBzAfzFFHaxOFIMUnFUd4Mnocd9BY";function d(){navigator&&"serviceWorker"in navigator?(navigator.serviceWorker.register("/sw.js",{scope:"/"}),navigator.serviceWorker.ready.then(function(e){e.active&&e.pushManager&&e.pushManager.getSubscription().then(function(t){t?i.register(r()(t,{p256dh:t.getKey("p256dh"),auth:t.getKey("auth")})):function(e){e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l(u)}).then(function(e){i.register(e)})}(e)})}).catch(function(e){console.log(e)})):console.log("Service workers are not supported.")}function l(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),a=new Uint8Array(n.length),r=0;r<n.length;++r)a[r]=n.charCodeAt(r);return a}function p(){"undefined"!==typeof Notification&&Notification&&"denied"!==Notification.permission&&(d(),Notification.requestPermission().then(function(e){}))}function g(){window.open("/notification?appToken="+s.a.getToken(),"Cho ph\xe9p g\u1eedi th\xf4ng b\xe1o t\u1edbi b\u1ea1n","height=400,width=500")}function m(){return"undefined"!==typeof Notification&&Notification?Notification.permission:null}function f(){return i.checkRegistered().then(function(e){var t=e&&!0===e.registered;return t||d(),t})}function h(e){var t=JSON.parse(c.a.getItem("".concat(e,".sw")));return!t||!t.lastAsk||Date.now()-t.lastAsk>=3e7}},209:function(e,t,n){"use strict";var a=n(6);t.a={userUpdated:function(e,t){return a.a.requests.post("/livechat/information-bot/user-updated",t)}}},219:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n(34),r=n.n(a),o=n(11),i=n.n(o),s=n(4),c=n(7),u=n(1),d=n(116),l={faqPageLoad:function(){return function(e){c.e.getAll().then(function(t){var n;e((n={categories:t},{type:s.b.FAQ_CATEGORIES_LOADED,payload:n}))})}},loadFAQList:function(e){return function(t){c.e.getByCategory(e).then(function(e){var n;t((n={faqs:e},{type:s.b.FAQ_CATEGORIES_FAQS_LOADED,payload:n}))})}},loadAllFAQs:function(){return function(e){c.e.getAllFAQs().then(function(t){e(u.a.write(u.a.tableNames.faqs,t)),e({type:"ALL_FAQS_LOADED"})})}},getVotedFAQs:function(){return function(e){c.e.getVotedFAQs().then(function(t){e({type:"VOTED_FAQS_LOADED",payload:{voted:t}})})}},searchFaqs:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.replace(/\s+/g,"").trim();if(i()(n))return[];return r()(e,function(e){var n=Object(d.c)(e.title).toLowerCase(),a=Object(d.c)(e.description).toLowerCase(),r=Object(d.c)(e.content).toLowerCase(),o=Object(d.b)(t),i=n.includes(o),s=a.includes(o),c=r.includes(o);return i||s||c})}}},222:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return s});var a=n(358),r=n.n(a);function o(e){return(e=e||"").replace(/\s\s+/g," ").trim()}function i(e){if(e)return r()(e.split(".").pop())}function s(e){switch(e){case"image":case"image/jpeg":case"image/png":case"image/gif":return"image";case"csat/label":case"text/html":return"text";case"form":return"form";case"video":return"video";default:return"file"}}},223:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var a=n(21),r=n.n(a),o=n(20),i=n(50),s=n(2),c=n(15),u=n.n(c),d=n(36),l=n.n(d),p=n(34),g=n.n(p),m=n(3),f=n.n(m),h=n(4),v=n(7),b=n(209),y=n(1),E={update:function(e,t){return function(n){var a;return n((a={data:e},{type:h.f.UPDATE_REQUEST,payload:a})),v.i.updateVisitorByBot(e,t.visitor._id).then(function(){var a;b.a.userUpdated(t.visitor.appId,{data:e,context:t}),n((a={data:e,context:t},{type:h.f.UPDATE_SUCCESS,payload:a}))}).catch(function(){var e;n((e={},{type:h.f.UPDATE_FAILED,payload:e}))})}},voteFAQ:function(e,t){return function(n){v.i.voteFAQ(e,t).then(function(){n({type:"VOTED",payload:{data:e,faqId:t}})})}},loadAgent:function(e){return function(t){return v.i.getAgent(e).then(function(e){t(y.a.write(y.a.tableNames.agents,e))})}},getPreChatSurvey:function(){return function(e,t){var n=t(),a=f()(n,"auth.visitor._id");return v.i.getPreChatSurvey(a).then(function(t){return e({type:"PRECHAT_SURVEY_LOADED",payload:{preChatConfig:t||{}}}),!!t})}},startPreChatSurvey:function(){return function(e,t){var n=t(),a=f()(n,"common.preChatConfig"),r=f()(n,"auth.visitor");return e({type:"PRECHAT_SURVEY_STARTED",payload:{preChatConfig:Object(s.a)({},a,{fields:g()(f()(a,"fields"),function(e){switch(e.code){case"name":return f()(r,"nameGenerated")||!f()(r,e.code);default:return!f()(r,e.code)}})})}})}},closePreChatSurvey:function(){return function(e){return e({type:"PRECHAT_SURVEY_CLOSED"})}},submitPreChatSurvey:function(e){return function(){var t=Object(i.a)(r.a.mark(function t(n,a){var i,s,c,d,p;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=a(),s=f()(i,"auth.visitor._id"),c=f()(i,"conversation.conversationId"),d=f()(i,"conversation.conversationAssignedUUID"),p=Object(o.a)(l()(f()(i,"common.preChatConfig.fields"),function(t){return u()(Object.keys(e),function(e){return e===f()(t,"fieldId")})})),n({type:"PRECHAT_SURVEY_SUBMITTED",payload:p}),v.i.submitPreChatSurvey(s,{conversationId:c,conversationAssignedUUID:d,payload:e}).then(function(e){c||n({type:h.c.NEW_CONVERSATION,payload:{conversation:e}})}),t.abrupt("return",p);case 8:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}}},225:function(e,t,n){"use strict";n.d(t,"b",function(){return U}),n.d(t,"a",function(){return L}),n.d(t,"c",function(){return M}),n.d(t,"d",function(){return V});var a=n(2),r=n(348),o=n.n(r),i=n(40),s=n.n(i),c=n(118),u=n.n(c),d=n(55),l=n.n(d),p=n(23),g=n.n(p),m=n(115),f=n.n(m),h=n(163),v=n.n(h),b=n(226),y=n.n(b),E=n(3),A=n.n(E),O=n(47),S=n.n(O),I=n(15),T=n.n(I),_=n(31),C=n.n(_),N=n(213),D=n(349),w=n.n(D),j=n(42),k=n.n(j),P=n(153),R="DD/MM/YYYY",U=/^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/,L=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,B="faqSuggestionBot",M={getAssignee:function(e){if(!e)return;return{name:x(e),avatarName:v()(e.firstName),profilePicture:e.profilePicture,online:e.online}},getAvatarCharacters:function(e){return y()(v()(A()(e,"firstName")))},getColor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e||0===S()(e))return F[0];return F[e.charCodeAt(0)%F.length]},getDomainFromUrl:function(e){e=e||"";return A()(e.match(/^(?:https?:)?(?:\/\/)?(?:[^@/\n]+@)?(?:www.)?([^:/\n]+)/),1)},isOnMobile:function(){return window.screen.width<=450},getAssigneeName:x,getProfilePicture:function(e){if(!e)return;if(e.indexOf("http://")>=0||e.indexOf("https://")>=0)return e;return k.a.DOMAIN?k.a.DOMAIN+e:e},isScrollAtBottom:function(e){var t=e.scrollHeight-e.clientHeight,n=e.scrollTop;return t<=0||n===t},groupMessage:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=[],o=[];n.forEach(function(n){var i=C()(n.timestamps).format(R),s=n.author||{};if(t===i&&H(e)===H(s)||!o.length){var c=f()(o);c&&C()(n.timestamps).diff(C()(c.timestamps),"minutes")>60&&(o[o.length-1]=Object(a.a)({},o[o.length-1],{isShowTime:!0})),o.push(n)}else o[o.length-1]=Object(a.a)({},o[o.length-1],{isShowTime:!0}),r.push(o),t!==i&&r.push([{type:"system",blocks:[{type:"system",contentType:"newDate",content:G(i)}]}]),o=[n];e=s,t=i}),o.length&&(o[o.length-1]=Object(a.a)({},o[o.length-1],{isShowTime:!0}),r.push(o));return r},convertEmoticonToEmoji:function(e){if(g()(e))return"";return l()(P.c,function(t){for(var n=new RegExp("(?:^|\\s)(".concat(t.regex,"){1}(?![^\\s])"),"g"),a=n.exec(e);a;)g()(u()(a,0))||g()(u()(a,1))?a=n.exec(e):(e=32===a[0].charCodeAt(0)||10===a[0].charCodeAt(0)?e.substring(0,a.index+1)+t.emoji+e.substring(a.index+1+a[1].length,e.length):e.substring(0,a.index)+t.emoji+e.substring(a.index+a[1].length,e.length),a=n.exec(e))}),e},encodeMessageText:function(e){var t=N.AllHtmlEntities.decode(e);return N.AllHtmlEntities.encode(t)},createTextLinks:function(e){return w()(e,{className:"",defaultProtocol:"http"})},hasAnswerBot:function(e){return e&&T()(e.appConfigStatus,function(e){return!0===e.v&&e.k===B})}};var F=["#FF6633","#FFB399","#00B3E6","#E6B333","#3366E6","#a2877c","#B34D4D","#80B300","#809900","#e45e53","#6680B3","#66991A","#FF99E6","#CCFF1A","#FF1A66","#E6331A","#33FFCC","#66994D","#B366CC","#FF8B48","#CC80CC","#66664D","#991AFF","#E666FF","#4DB3FF","#1AB399","#E666B3","#33991A","#CC9999","#B3B31A","#00E680","#4D8066","#04403B","#E6FF80","#999933","#FF3380","#CCCC00","#66E64D","#4D80CC","#9900B3","#E64D66","#4DB380","#FF4D4D","#99E6E6","#6666FF"];function x(e){if(e.isBot)return e.name;var t=A()(e,"firstName",""),n=A()(e,"lastName","");return"".concat(n," ").concat(t)}function H(e){return e.authorId||e.type}function G(e){return function(e){var t=C()().subtract(1,"day").format(R);return e===t}(e)?"H\xf4m qua":function(e){var t=C()().format(R);return e===t}(e)?"H\xf4m nay":e}function V(e){return s()(e,"://")?o()(e,"://")[1]:e}},318:function(e,t,n){"use strict";var a=n(24),r=n(28),o=n(26),i=n(25),s=n(27),c=n(11),u=n.n(c),d=n(3),l=n.n(d),p=n(0),g=n.n(p),m=n(22),f=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.app,n=e.from,a=l()(t,"widgetConfig.brand");if(l()(t,"pricingPackageConfig.details.hideLogo"))return null;if(a&&!u()(a))return this.renderCustomBrand(a);var r="https://oncustomer.asia/?company=".concat(t.name,"&companyId=").concat(t._id,"&utm_source=desktop-web&utm_medium=messenger&utm_campaign=oncustomer-link&position=").concat(n);return g.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:r},g.a.createElement("img",{src:"/images/by-oncustomer-footer.png",alt:"By OnCustomer"}))}},{key:"renderCustomBrand",value:function(e){return g.a.createElement("a",{rel:"noopener noreferrer",target:"_blank"},g.a.createElement("img",{src:e,alt:"Logo custom"}))}}]),t}(g.a.Component);t.a=Object(m.connect)(function(e){return{app:e.common.app}})(f)},362:function(e){e.exports={welcome:"Hi there","Danh s\xe1ch h\u1ed9i tho\u1ea1i":"Conversations","T\u1ea5t c\u1ea3":"View all","H\u1ed9i tho\u1ea1i m\u1edbi":"Start conversation","Ch\xfang t\xf4i th\u01b0\u1eddng tr\u1ea3 l\u1eddi trong v\xe0i ph\xfat":"We usually reply in a few minutes","Ch\xfang t\xf4i th\u01b0\u1eddng tr\u1ea3 l\u1eddi ngay khi \u0111\u01b0\u1ee3c h\u1ecfi":"We usually reply immediately","C\xe2u h\u1ecfi th\u01b0\u1eddng g\u1eb7p":"FAQs","Danh m\u1ee5c":"Categories","B\u1ea1n th\u1ea5y b\xe0i vi\u1ebft h\u1eefu \xedch v\u1edbi b\u1ea1n?":"Was this article useful?","Nh\u1eadp tin nh\u1eafn":"Reply here","C\xf3 l\u1ed7i, click \u0111\u1ec3 th\u1eed l\u1ea1i":"Error happens, click to retry","\u0110ang g\u1eedi":"Sending","Click \u0111\u1ec3 ch\u1ecdn":"Click to select","Click \u0111\u1ec3 ch\u1ecdn ng\xe0y":"Click to select date","C\xf3":"Yes","Kh\xf4ng":"No","Nh\xe2n vi\xean h\u1ed7 tr\u1ee3 kh\xe1ch h\xe0ng":"Customer support specialist","Ho\u1ea1t \u0111\u1ed9ng":"Online","\u0110ang v\u1eafng m\u1eb7t":"Away","H\xe3y b\u1eaft \u0111\u1ea7u tr\xf2 chuy\u1ec7n":"Send us message","T\xecm ki\u1ebfm":"Search","Kh\xf4ng t\xecm th\u1ea5y k\u1ebft qu\u1ea3 n\xe0o cho":"No result for","K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm":"Search results","k\u1ebft qu\u1ea3 t\u1eeb":"result from","k\u1ebft qu\u1ea3 t\u1eeb danh m\u1ee5c kh\xe1c":"result from other categories","H\u1ed9i tho\u1ea1i c\u0169":"Old conversations","Xem th\xeam danh m\u1ee5c kh\xe1c":"View other categories","b\u1ea1n ch\u01b0a nh\u1eadp email":"Email missing","c\xf3 v\u1ebb b\u1ea1n nh\u1eadp sai \u0111\u1ecbnh d\u1ea1ng":"it looks like you entered wrong format","c\xf3 v\u1ebb b\u1ea1n \u0111\xe3 nh\u1eadp thi\u1ebfu s\u1ed1":"it looks like you entered not correct number","b\u1ea1n ch\u01b0a nh\u1eadp s\u1ed1 \u0111i\u1ec7n tho\u1ea1i":"please enter phone number","S\u1ed1 \u0111i\u1ec7n tho\u1ea1i":"Phone number","C\u1ea3m \u01a1n b\u1ea1n \u0111\xe3 \u0111\xe1nh gi\xe1":"Thanks for rating","H\xe3y nh\u1eadp nh\u1eadn x\xe9t c\u1ee7a b\u1ea1n":"Please leave your comment","v\xe0 nh\u1eadn x\xe9t":"and left comment","G\u1ea7n \u0111\xe2y":"Recently","\u0110\u1ecbnh d\u1ea1ng file kh\xf4ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 ":"File format is not supported ","File v\u01b0\u1ee3t qu\xe1 dung l\u01b0\u1ee3ng cho ph\xe9p 35MB":"File size exceeded limited of 35MB","C\xf3 v\u1ebb nh\u01b0 m\u1ea1ng Internet kh\xf4ng ho\u1ea1t \u0111\u1ed9ng, vui l\xf2ng ki\u1ec3m tra":"Please check the network connection","H\xe3y cho ph\xe9p ch\xfang t\xf4i g\u1eedi th\xf4ng b\xe1o \u0111\u1ec3 kh\xf4ng b\u1ecf l\u1ee1 nh\u1eefng th\xf4ng tin th\xfa v\u1ecb!":"Please allow us sending notification","Cho ph\xe9p":"Accept","\u0110\u1ec3 sau":"Later","m\u1edbi \u0111\xe2y":"now","<p>Click <strong>Cho ph\xe9p</strong> \u0111\u1ec3 cho ph\xe9p g\u1eedi notification</p><p>Kh\xf4ng b\u1ecf l\u1ee1 tin nh\u1eafn t\u1eeb trang web</p>":"<p>Click <strong>Accept</strong> to allow sending notification</p>","C\xf3 v\u1ebb b\u1ea1n \u0111\xe3 ch\u1eb7n th\xf4ng b\xe1o t\u1eeb trang web":"It seem that you blocked notification for this page","Vui l\xf2ng l\xe0m theo":"Please follow this","h\u01b0\u1edbng d\u1eabn":"instruction","\u0111\u1ec3 c\xf3 th\u1ec3 nh\u1eadn th\xf4ng b\xe1o":"to allow sending notification","C\u1ea3m \u01a1n b\u1ea1n! b\u1ea1n \u0111\xe3 cho ph\xe9p g\u1eedi th\xf4ng b\xe1o":"Thanks for allow us sending notification","B\u1ea1n c\xf3 th\u1ec3 <strong>\u0111\xf3ng c\u1eeda s\u1ed5</strong> v\xe0 quay l\u1ea1i trang web":"You can now <strong>close window</strong> and back to the website","Gi\u1eadn d\u1eef":"Angry","Th\u1ea5t v\u1ecdng":"Bad","T\u1ea1m \u1ed5n":"Fine","T\u1ed1t":"Good","Tuy\u1ec7t v\u1eddi":"Excellent","Tin nh\u1eafn h\xecnh \u1ea3nh":"Image","Tin nh\u1eafn video":"Video","Tin nh\u1eafn file \u0111\xednh k\xe8m":"Attachment","G\u1eedi th\xf4ng tin":"Complete","B\u1ecf qua":"Dismiss","G\u1eedi":"Send","Ho\xe0n th\xe0nh":"Complete","ho\u1eb7c nh\u1ea5n Enter":"or press Enter","Vui l\xf2ng kh\xf4ng \u0111\u1ec3 tr\u1ed1ng th\xf4ng tin":"You are likely to submit the wrong format","C\xf3 v\u1ebb b\u1ea1n \u0111\xe3 nh\u1eadp sai \u0111\u1ecbnh d\u1ea1ng":"Please do not leave any blank","C\xe2u tr\u1ea3 l\u1eddi g\u1ee3i \xfd":"Suggested answers"}},363:function(e){e.exports={welcome:"Xin ch\xe0o","Danh s\xe1ch h\u1ed9i tho\u1ea1i":"Danh s\xe1ch h\u1ed9i tho\u1ea1i"}},37:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a={},r={setItem:function(e,t){try{localStorage.setItem(e,t)}catch(n){a[e]=t}},getItem:function(e){try{return localStorage.getItem(e)}catch(t){return a[e]}}}},383:function(e,t,n){n(384),e.exports=n(659)},4:function(e,t,n){"use strict";var a={ASK_PERMISSION_SW:"ASK_PERMISSION_SW",CLOSE_ASK_PERMISSION_SW:"CLOSE_ASK_PERMISSION_SW"},r={GET_INFO_USER:"GET_INFO_USER",UPDATE_REQUEST:"USERS_UPDATE_REQUEST",UPDATE_SUCCESS:"USERS_UPDATE_SUCCESS",UPDATE_FAILED:"USERS_UPDATE_FAILED"},o=n(153),i={NEW_MESSAGE:"NEW_MESSAGE",MESSAGE_SENDING:"MESSAGE_SENDING",MESSAGE_SENT_SUCCESSFULLY:"MESSAGE_SENT_SUCCESSFULLY",MESSAGE_UNREAD_LOADED:"MESSAGE_UNREAD_LOADED"},s={NEW_CONVERSATION:"NEW_CONVERSATION",NEW_CONVERSATION_CREATING:"NEW_CONVERSATION_CREATING",CONVERSATION_CREATED:"CONVERSATION_CREATED",CONVERSATION_ASSIGNED:"CONVERSATION_ASSIGNED",CONVERSATION_CREATED_FAILED:"CONVERSATION_CREATED_FAILED",CONVERSATION_READ_BY_USER:"CONVERSATION_READ_BY_USER"};n.d(t,"a",function(){return a}),n.d(t,"f",function(){return r}),n.d(t,"b",function(){return o.a}),n.d(t,"d",function(){return o.b}),n.d(t,"e",function(){return i}),n.d(t,"c",function(){return s})},41:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n(3),r=n.n(a),o=n(6),i=n(58),s={getToken:u,init:function(e){var t=u();return o.a.requests.post("/user/widget/init?appToken=".concat(t),e).catch(function(n){var a=r()(n,"response.body.message");if("not_in_whitelisted_domains"===a)throw n;return o.a.requests.post("/user/widget/init?appToken=".concat(t),e)})},getMainData:function(){return o.a.requests.get("/user/widget/main-data")},getLanguage:function(){return c.lang}},c={token:i.a.getUrlParameter("appToken"),lang:i.a.getUrlParameter("lang")||"vi"};function u(){return c.token}},42:function(e,t,n){n(435);var a=n(436),r=(n(437),a);e.exports=r},43:function(e,t,n){"use strict";var a=n(3),r=n.n(a),o=n(15),i=n.n(o),s=n(16),c=n.n(s),u=n(6);function d(e,t,n,a){var o=a.runId,s=a.app,u=i()(n.script.paths,["isDefault",!0]),d=r()(u,"steps.0.data.blocks");return{appId:e,_id:c()(),author:l(n,s),timestamps:Date.now(),type:"message",conversationId:t,blocks:d,meta:{botInfo:{runId:o,botId:n._id}}}}function l(e,t){return{authorId:e._id,name:r()(t,"name"),profilePicture:r()(t,"logo"),type:"bot",isBot:!0,nameGenerated:!1}}t.a={newConversation:function(e,t,n){var a=n.runId,r=n.app,o=c()();return{appId:e,_id:o,conversationAssignedUUID:o,unreadByUser:!0,isClientSide:!0,status:"open",lastMessage:d(e,o,t,{runId:a,app:r}),meta:{botInfo:{runId:a,botId:t._id}}}},startBot:function(e,t){return u.a.requests.post("livechat/custom-bot/".concat(e._id,"/start"),{params:t})},transition:function(e,t,n,a,r){return u.a.requests.post("livechat/custom-bot/".concat(e,"/transition"),{runId:t,stepId:a,pathId:n,params:r})},newBranchingMessage:function(e,t,n,a,o){var s=o.runId,u=o.app,d=i()(a.steps,["type","branching"]),p=r()(d,"data.branches");return{appId:e,_id:c()(),author:l(n,u),timestamps:Date.now()+1,type:"botAction",conversationId:t,meta:{botInfo:{runId:s,botId:n._id}},blocks:[{contentType:"branching",content:null,meta:{branches:p,pathId:a.id,stepId:d.id}}]}},isBotInProgress:function(e,t){var n=r()(t,"meta.botInfo.runId"),a=e.bot.runningBots[n];return n&&a&&!t.meta.botInfo.completed&&!a.completed},getBotSimulation:function(e){return u.a.requests.get("livechat/custom-bot/".concat(e,"?isSimulating=true"))},getCustomFieldById:function(e){return u.a.requests.get("user/custom-field/".concat(e))},handleInteract:function(e){return u.a.requests.post("livechat/custom-bot/interact",e)}}},435:function(e,t,n){"use strict";n.r(t);t.default={API_ROOT:"https://api-internal-dev.oncustomer.asia/",GOOGLE:{CLIENT_ID:"1046019861050-osnp6e28g91m3m7t1qend0v07s5ks7se.apps.googleusercontent.com"},SOCKET:{SERVER:"https://push-dev.oncustomer.asia/"},FACEBOOK_APP:"550830269096964",LIVE:{PING_INTERVAL:3e3},FEEDBACK_ROOT_PATH:"http://localhost:8080"}},436:function(e,t,n){"use strict";n.r(t);t.default={API_ROOT:"https://api-internal.oncustomer.asia/",STATIC_ROOT:"https://static.oncustomer.asia/",GOOGLE:{CLIENT_ID:"1046019861050-osnp6e28g91m3m7t1qend0v07s5ks7se.apps.googleusercontent.com"},SOCKET:{SERVER:"https://push.oncustomer.asia/"},FACEBOOK_APP:"592359997845571",LIVE:{PING_INTERVAL:6e4},FEEDBACK_ROOT_PATH:"https://feedback.oncustomer.asia"}},437:function(e,t,n){"use strict";n.r(t);t.default={API_ROOT:"https://api-internal-local.oncustomer.com/",STATIC_ROOT:"https://api-internal-local.oncustomer.com/",GOOGLE:{CLIENT_ID:"1046019861050-osnp6e28g91m3m7t1qend0v07s5ks7se.apps.googleusercontent.com"},SOCKET:{SERVER:"http://oc:8086/"},FACEBOOK_APP:"550830269096964",LIVE:{PING_INTERVAL:3e3},FEEDBACK_ROOT_PATH:"http://localhost:8080"}},44:function(e,t,n){"use strict";var a=n(55),r=n.n(a),o=n(16),i=n.n(o),s=n(158),c={},u={};function d(e,t,n){return c[e]={callback:n},window.parent.postMessage({method:"oc-listen-event",eventConfig:t,listenerId:e},"*"),e}window.addEventListener("message",function(e){if("oc-listen-event-triggered"===e.data.method&&c[e.data.listenerId]){var t=c[e.data.listenerId].callback;t&&t(e.data.payload)}}),t.a={addEventListener:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i()();return n.poll?function(e,t,n){u[e]={callback:n,eventConfig:t}}(a,e,t):d(a,e,t)},removeEventListener:function(e){delete c[e],delete u[e]},checkPoll:function(){r()(u,function(e,t){(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.a.query({targetType:e.targetType,targetPath:e.targetPath,path:"tagName"}).then(function(e){return!!e})})(e.eventConfig).then(function(n){n&&u[t]&&(delete u[t],d(t,e.eventConfig,e.callback))})})}}},48:function(e,t,n){"use strict";var a=n(19),r=n.n(a),o=n(186),i=n.n(o),s=n(11),c=n.n(s),u=n(79),d=n.n(u),l=n(95),p=n.n(l),g=n(295),m=n.n(g),f=n(212),h=n(16),v=n.n(h),b=n(58),y=n(77),E=n(76),A=n(9),O=n(6),S=n(3),I=n.n(S),T=n(99);var _={showWidget:function(){I()(A.b.getState(),"common.widgetOpen")||A.b.dispatch(T.a.toggle({breadCrumbsUpdates:{currentPage:"home"},widgetOpen:!0}))},hideWidget:function(){I()(A.b.getState(),"common.widgetOpen")&&A.b.dispatch(T.a.toggle({widgetOpen:!1}))},initMessage:function(e){A.b.dispatch({type:"RECEIVE_MESSAGE_FROM_PARENT_WINDOW",payload:{message:e.data.content}}),A.b.dispatch(T.a.toggle({breadCrumbsUpdates:{breadCrumbs:[{page:"home"},{page:"conversation"}],currentPage:"conversation"},widgetOpen:!0}))}},C=n(148);n.d(t,"a",function(){return w});var N=["custom_launcher_selector"],D=["hooks"],w={getLocation:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c()(P)&&L();var t=e?P:d()(P,["url","title"]);t&&t.title&&"undefined"!==t.title||(t.referrer?i()(t,"title",window.location.href):i()(t,"referrer",window.location.href));return t},getUserData:function(){return R},getBotSimulationId:function(){return U},getSettings:function(){return k}},j={"init-message":_.initMessage,"trigger:show-widget":_.showWidget,"trigger:hide-widget":_.hideWidget},k={},P={},R={},U=null;function L(){var e=b.a.getUrlParameter("ocvisitordata");if(e)try{var t=JSON.parse(f.Base64.decode(e));R=m()(t,p()(N,D)),k=d()(t,N)}catch(a){console.log("OCWidget",a)}var n=b.a.getUrlParameter("ocdata");if(n)try{P=JSON.parse(f.Base64.decode(n))}catch(a){console.log("OCWidget",a),P.title=window.location.search}U=b.a.getUrlParameter("botSimulationId")}function B(e){if(e&&e.data){if("sendMessage"===e.data.type)return function e(t){try{if(!O.a.getVisitor())return setTimeout(function(){return e(t)},100);var n=t.content;r()(n,function(e){e&&e.text&&C.a.sendText(null,v()(),e.text)(A.b.dispatch)})}catch(a){console.log("OnCustomer sending error",a)}}(e.data);if("change-url"===e.data.type)return y.a.userVisitPage(e.data);if("browser:focus-change"===e.data.type)return y.a.sendToServer({eventName:"browser-tab:focus",value:e.data.value});if("parentActive"===e.data.type&&A.b.dispatch({type:"PARENT_IS_ACTIVE_UPDATE",payload:{isActive:e.data.value}}),j[e.data.type]&&j[e.data.type](e),"oc-iframe-max-height"===e.data.method){var t=e.data.maxHeight,n=document.getElementById("popup"),a=document.getElementById("btn-start-chat");if(!n||!a)return;var o=getComputedStyle(n).bottom,i=getComputedStyle(a).height,s=t-parseInt(o)-parseInt(i),c=document.getElementById("list-message");if(!c)return;c.style.maxHeight="".concat(s,"px")}}}L(),window.addEventListener?window.addEventListener("message",B):window.attachEvent("message",B);try{Object(E.g)("oc-widget-ready")}catch(M){}},51:function(e,t,n){"use strict";var a=n(2),r=n(55),o=n.n(r),i=n(23),s=n.n(i),c=n(79),u=n.n(c),d=n(96),l=n.n(d),p=n(16),g=n.n(p),m=n(44),f={};var h={deregister:function(e){var t=f[e];t&&(m.a.removeEventListener(t.mouseEnterListenerId),m.a.removeEventListener(t.mouseLeaveListenerId),delete f[e])},register:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=g()(),o=m.a.addEventListener({eventType:"mouseenter",targetType:e,targetPath:t},function(){var e=f[r];e&&(e.hoveredAt=Date.now(),"function"===typeof e.mouseEnterCallback&&e.mouseEnterCallback(e.hoveredAt))},{poll:n.poll}),i=m.a.addEventListener({eventType:"mouseleave",targetType:e,targetPath:t},function(){var e=f[r];e&&("function"===typeof e.mouseLeaveCallback&&e.mouseLeaveCallback(Date.now()-e.hoveredAt),e.durationReached=!1,delete e.hoveredAt)},{poll:n.poll});return f[r]=Object(a.a)({},l()(u()(n,["mouseEnterCallback","mouseLeaveCallback","duration","durationCallback"]),s.a),{mouseEnterListenerId:o,mouseLeaveListenerId:i}),r},checkDuration:function(){o()(f,function(e,t){e&&e.hoveredAt&&!e.durationReached&&e.duration&&"function"===typeof e.durationCallback&&Date.now()-e.hoveredAt>e.duration&&(e.durationReached=!0,e.durationCallback())})}},v=n(158);t.a={checkHoverDuration:h.checkDuration,registerHover:h.register,deregisterHover:h.deregister,addEventListener:m.a.addEventListener,removeEventListener:m.a.removeEventListener,query:v.a.query,checkPoll:m.a.checkPoll}},54:function(e,t,n){"use strict";var a=n(21),r=n.n(a),o=n(2),i=n(50),s=n(356),c=n.n(s),u=n(357),d=n.n(u),l=n(122),p=n.n(l),g=n(120),m=n.n(g),f=n(214),h=n.n(f),v=n(57),b=n.n(v),y=n(316),E=n.n(y),A=n(34),O=n.n(A),S=n(117),I=n.n(S),T=n(11),_=n.n(T),C=n(15),N=n.n(C),D=n(3),w=n.n(D),j=n(16),k=n.n(j),P=n(43),R=n(7),U=n(4),L=n(1),B=n(51);function M(e){return function(){var t=Object(i.a)(r.a.mark(function t(n,a){var i,s,c,u,d,l,p,g,m,f,h,v;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!x(i=a())(e)&&!H(i)(e)){t.next=3;break}return t.abrupt("return");case 3:return s={isSimulating:w()(i,"common.isSimulating")},n({type:"CUSTOM_BOT_STARTING",payload:{botId:e._id}}),t.next=7,P.a.startBot(e,s);case 7:c=t.sent,u=c.runId,d=i.common.app._id,l=P.a.newConversation(d,e,{runId:u,app:i.common.app}),n(L.a.write(L.a.tableNames.conversations,l)),p=l.lastMessage,g=N()(e.script.paths,["isDefault",!0]),m=P.a.newBranchingMessage(d,l._id,e,g,{runId:u,app:i.common.app}),f=[p,m],n(L.a.write(L.a.tableNames.messages,f)),h=w()(m,"blocks.0.meta.pathId"),v=w()(m,"blocks.0.meta.stepId"),n({type:"CUSTOM_BOT_STARTED",payload:{botId:e._id,runId:u,conversationId:l._id,stepId:v,pathId:h}}),n({type:"NEW_NOTIFICATION_MESSAGE",payload:{messages:f}}),n(L.a.update(L.a.tableNames.conversations,l._id,{meta:{botInfo:Object(o.a)({},l.meta.botInfo,{stepId:v,pathId:h})}}));case 22:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()}function F(e,t,n,a,o,s){s.conversationId;return function(){var s=Object(i.a)(r.a.mark(function i(s,c){var u,d;return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return u=c(),(d=w()(u,"common.isSimulating"))&&(o.isSimulating=d),r.abrupt("return",P.a.transition(e,t,n,a,o));case 4:case"end":return r.stop()}},i)}));return function(e,t){return s.apply(this,arguments)}}()}function x(e){var t=Object.values(w()(e,"bot.runningBots",{})).map(function(e){return e.botId});return function(e){return t.includes(e._id)}}function H(e){var t=w()(e,"bot.startingBots",{});return function(e){return t[e._id]}}t.a={startBot:M,chooseBranch:function(e,t){return function(){var n=Object(i.a)(r.a.mark(function n(a,i){var s,c,u,d,l,p,g,m,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(s=i(),c=w()(e,"meta.botInfo.runId"),u=w()(e,"blocks.0.meta")||{},d=s.bot.runningBots[c]){n.next=6;break}return n.abrupt("return");case 6:return l=L.a.getTable(s,L.a.tableNames.conversations),p=L.a.get(l,e.conversationId),g=k()(),m=Object(o.a)({},e.blocks[0],{content:t.text}),a(L.a.update(L.a.tableNames.messages,e._id,{blocks:[m]})),a({type:U.e.MESSAGE_SENDING,payload:{conversationId:e.conversationId,author:R.i.getAuthor(),clientAssignedUUID:g,blocks:[{contentType:"text/html",content:t.text}]}}),f={clientAssignedUUID:g,messageId:e._id,branch:t,location:R.g.getLocation(),conversationId:p.isClientSide?null:p._id,conversationAssignedUUID:d.conversationId},p.isClientSide||(f.conversationId=p._id),n.abrupt("return",a(F(d.botId,c,u.pathId,u.stepId,f,{conversationId:p.isClientSide?null:p._id})));case 15:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()},checkMessage:function(e,t){return function(){var n=Object(i.a)(r.a.mark(function n(a,o){var i,s,c,u,d,l,p,g,m,f;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=o(),s=w()(e,"meta.botInfo.runId"),c=i.bot.runningBots[s]){n.next=5;break}return n.abrupt("return");case 5:if(u=c.botId,d=c.pathId,l=c.stepId,p=L.a.getTable(i,L.a.tableNames.customBots),g=L.a.get(p,u)){n.next=12;break}return n.abrupt("return");case 12:if(m=N()(g.script.paths,["id",d]),!_()(m)){n.next=15;break}return n.abrupt("return");case 15:if(f=N()(m.steps,["id",l]),!_()(f)){n.next=18;break}return n.abrupt("return");case 18:if("receiveMessage"!==f.type){n.next=20;break}return n.abrupt("return",a(F(u,s,d,l,{conversationId:e._id},{conversationId:e._id})));case 20:if("inputField"!==f.type){n.next=22;break}return n.abrupt("return",a(F(u,s,d,l,{value:w()(t,"blocks.0.content"),conversationId:e._id,fromMessage:!0},{conversationId:e._id})));case 22:case"end":return n.stop()}},n)}));return function(e,t){return n.apply(this,arguments)}}()},rehydrateBotProgress:function(e){return function(t){O()(e,function(e){return E()(e,"meta.botInfo.runId")&&!e.meta.botInfo.completed}).forEach(function(e){var n=e.meta.botInfo;t({type:"CUSTOM_BOT_CONVERSATION_UPDATED",payload:{runId:n.runId,conversationId:e._id,pathId:n.pathId,stepId:n.stepId,botId:n.botId}})})}},newConversation:function(e,t){return function(n,a){var r=a(),o=L.a.getTable(r,L.a.tableNames.messages),i=I()(L.a.query(o,{conversationId:e._id}),["timestamps","desc"]),s=e.meta.botInfo,c=s.botId,u=s.runId,d=s.pathId,l=s.stepId;return R.h.newBotConversation(c,i,t,{runId:u,pathId:d,stepId:l,conversationAssignedUUID:e._id}).then(function(e){var t=e.conversation;return n({type:"CUSTOM_BOT_CONVERSATION_UPDATED",payload:{runId:u,conversationId:t._id,pathId:d,stepId:l}}),t})}},sendInputField:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(a,r){var i=r(),s=w()(e,"meta.botInfo.runId"),c=w()(e,"blocks.0.meta")||{},u=k()(),d=i.bot.runningBots[s];if(d){var l=Object(o.a)({},e.blocks[0],{content:t});a(L.a.update(L.a.tableNames.messages,e._id,{blocks:[l]})),n.showReply&&a({type:U.e.MESSAGE_SENDING,payload:{conversationId:e.conversationId,author:R.i.getAuthor(),clientAssignedUUID:u,blocks:[{contentType:"text/html",content:"".concat(n.textValue||t)}]}});var p={messageId:e._id,value:t,conversationId:e.conversationId,textValue:n.textValue,addReply:!0,showReply:!!n.showReply,clientAssignedUUID:u};return a(F(d.botId,s,c.pathId,c.stepId,p,{conversationId:e.conversationId}))}}},getCustomFieldById:function(e){return function(){var t=Object(i.a)(r.a.mark(function t(n){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.a.getCustomFieldById(e);case 2:a=t.sent,n(L.a.write(L.a.tableNames.customFields,a));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},processTriggerBot:function(){return function(e,t){var n=t(),a=L.a.getTable(n,L.a.tableNames.customBots),r=L.a.query(a,{}),o=b()(h()(["priority"],["asc"]),m()(function(e){return R.c.isConditionSatisfied(e.behaviorCondition)}),p()(x(n)),p()(H(n)))(r);return o[0]?(e(M(o[0])),o[0]):null}},setupSelectionBots:function(){return function(e,t){var n=t(),a=L.a.getTable(n,L.a.tableNames.customBots),r=L.a.query(a,{});b()(m()(function(e){return"selection"===e.type}),h()(["priority"],["asc"]),p()(x(n)),p()(H(n)))(r).forEach(function(t){return function(e,t){var n=w()(e,["behaviorCondition","conditions",0]);if(!_()(n))switch(n.attribute){case"hover":var a=n.value,r=B.a.registerHover(a.selectorType,a.selector,{poll:!0,duration:1e3*a.duration,durationCallback:function(){R.c.isConditionSatisfied(a.conditions)&&R.c.isConditionSatisfied(e.behaviorCondition,{hover:!0})&&(B.a.deregisterHover(r),t(M(e)))}});break;case"click":var o=n.value,i=B.a.addEventListener({eventType:"click",targetType:o.selectorType,targetPath:o.selector},function(){R.c.isConditionSatisfied(o.conditions)&&R.c.isConditionSatisfied(e.behaviorCondition,{click:!0})&&(B.a.removeEventListener(i),t(M(e)))},{poll:!0});break;case"scroll":var s=B.a.addEventListener({eventType:"scroll",targetType:"document",paths:[{key:"totalHeight",targetType:"document",path:["documentElement","scrollHeight"]},{key:"scrollHeight",targetType:"window",path:["pageYOffset"]},{key:"windowHeight",targetType:"window",path:["innerHeight"]}]},function(a){if(d()(a))return!1;var r=a.totalHeight,o=a.scrollHeight,i=a.windowHeight,u=r-i,l=o/u*100,p=!!c()(function(e){var t=e.condition,n=e.scrollPercentage;return l>=n&&R.c.isConditionSatisfied(t)},n.value);p&&R.c.isConditionSatisfied(e.behaviorCondition,{scroll:!0})&&(B.a.removeEventListener(s),t(M(e)))})}}(t,e)})}},handleInteract:function(e){return P.a.handleInteract(e)}}},570:function(e,t){},58:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(20),r={getBrowserLanguage:function(){var e=[].concat(Object(a.a)(window.navigator.languages||[]),[window.navigator.language,window.navigator.browserLanguage,window.navigator.userLanguage,window.navigator.systemLanguage]).filter(Boolean).map(function(e){return e.substr(0,2)});if(e)return e[0];return"en"},getUrlParameter:function(e){var t={},n=document.createElement("a");n.href=window.location.search;for(var a=n.search.substring(1).split("&"),r=0;r<a.length;r++){var o=a[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t[e]},onBrowerChangeTab:function(e){o.push(e)}},o=[]},6:function(e,t,n){"use strict";(function(e){var a,r,o=n(42),i=n.n(o),s=n(37),c=n(339),u=n.n(c),d=n(340),l=n.n(d),p=u()(l.a,e.Promise),g=i.a.API_ROOT,m=function(e){return e.body},f=null,h=function(e){f&&e.set("Authorization","Bearer ".concat(f)),a&&e.query({appId:a._id})},v={del:function(e){return p.del("".concat(g).concat(e)).use(h).then(m)},get:function(e){return p.get("".concat(g).concat(e)).use(h).then(m)},put:function(e,t){return p.put("".concat(g).concat(e),t).use(h).then(m)},post:function(e,t,n){return p.post("".concat(g).concat(e),t).use(h).on("progress",function(e){n&&n.onProgress&&n.onProgress({percent:e.percent})}).then(m)},patch:function(e,t){return p.patch("".concat(g).concat(e),t).use(h).then(m)}},b=function(e){f=e};t.a={loadStoredUser:function(e){try{var t=s.a.getItem(e+".visitor.token");t&&b(t)}catch(n){}},requests:v,setToken:b,setApp:function(e){a=e},getApp:function(){return a},waitForApp:function e(t){if(!a)return setTimeout(function(){return e(t)},100);t&&t(a)},saveVisitor:function(e,t,n){r=t,n||s.a.setItem(e+".visitor.token",t.token),b(t.token)},getVisitor:function(){return r},getVisitorToken:function(e){return f||s.a.getItem(e+".visitor.token")}}}).call(this,n(14))},608:function(e,t,n){"use strict";n.r(t);var a=n(319),r=n.n(a);n.d(t,"LoadingOutline",function(){return r.a});var o=n(320),i=n.n(o);n.d(t,"SearchOutline",function(){return i.a});var s=n(321),c=n.n(s);n.d(t,"SyncOutline",function(){return c.a});var u=n(322),d=n.n(u);n.d(t,"RightOutline",function(){return d.a});var l=n(323),p=n.n(l);n.d(t,"DislikeFill",function(){return p.a});var g=n(324),m=n.n(g);n.d(t,"LikeFill",function(){return m.a})},652:function(e,t,n){},654:function(e,t,n){},659:function(e,t,n){"use strict";n.r(t);var a=n(80),r=n.n(a),o=n(22),i=n(0),s=n.n(i),c=n(9),u=n(994),d=n(988),l=n(98),p=(n(498),n(24)),g=n(28),m=n(26),f=n(25),h=n(27),v=n(3),b=n.n(v),y=n(31),E=n.n(y),A=n(29),O=n(345);var S=function(e){var t=Object(O.a)(e);return s.a.createElement("style",null,"\n        .theme-color {\n          color: ".concat(e," !important;\n        }\n        .theme-color-bg-non-hover {\n          background-color: ").concat(e," !important;\n        }\n        .theme-color-bg {\n          background-color: ").concat(e," !important;\n          color: white !important;\n        }\n        .theme-color-bg:hover {\n          background-color: ").concat(t[6]," !important;\n        }\n        .theme-color-border-non-hover {\n          border-color: ").concat(e," !important;\n        }\n        .theme-color-border {\n          border-color: ").concat(e," !important;\n        }\n        .theme-color-border:hover {\n          border-color: ").concat(t[6]," !important;\n        }\n        .theme-color-bg-hover:hover {\n          background-color: ").concat(e," !important;\n          color: white !important;\n        }\n        .widget-tab-wrapper .ant-radio-button-wrapper.ant-radio-button-wrapper-checked {\n          border-color: ").concat(e," !important;\n        }\n        .ant-btn-primary {\n          background-color: ").concat(e," !important;\n          border-color: ").concat(e," !important;\n        }\n        .ant-btn-primary:hover, .ant-btn-primary:focus, .ant-btn-primary:active {\n          background-color: ").concat(t[6]," !important;\n          border-color: ").concat(t[6]," !important;\n        }\n        .ant-input-group-addon {\n          background-color: ").concat(e," !important;\n          border-color: ").concat(e," !important;\n        }\n        .ant-input-group-addon:hover {\n          background-color: ").concat(t[6]," !important;\n          border-color: ").concat(t[6]," !important;\n        }\n        .ant-select-selection:hover {\n          border-color: ").concat(e," !important;\n        }\n        .ant-select-focused .ant-select-selection, .ant-select-selection:focus, .ant-select-selection:active {\n          border-color: ").concat(e," !important;\n          box-shadow: 0 0 0 2px ").concat(e,"32;\n        }\n        .ant-select-dropdown-menu-item:hover:not(.ant-select-dropdown-menu-item-disabled),\n        .ant-select-dropdown-menu-item-active:not(.ant-select-dropdown-menu-item-disabled) {\n          background-color: ").concat(t[2]," !important;\n        }\n        .ant-calendar-picker:hover .ant-calendar-picker-input:not(.ant-input-disabled) {\n          border-color: ").concat(e," !important;\n        }\n        .ant-calendar-today-btn,\n        .ant-calendar-header a:hover {\n          color: ").concat(e," !important;\n        }\n        .ant-calendar-selected-day .ant-calendar-date {\n          background-color: ").concat(t[2]," !important;\n        }\n        .ant-calendar-today .ant-calendar-date {\n          color: ").concat(e," !important;\n          border-color: ").concat(e," !important;\n        }\n        .ant-calendar-date:hover,\n        .ant-calendar-month-panel-month:hover,\n        .ant-calendar-year-panel-year:hover,\n        .ant-calendar-decade-panel-decade:hover {\n          background-color: ").concat(t[2]," !important;\n        }\n        .ant-calendar-month-panel-selected-cell .ant-calendar-month-panel-month,\n        .ant-calendar-year-panel-selected-cell .ant-calendar-year-panel-year,\n        .ant-calendar-decade-panel-selected-cell .ant-calendar-decade-panel-decade {\n          color: #fff !important;\n          background: ").concat(e," !important;\n        }\n        .ant-calendar-month-panel-selected-cell .ant-calendar-month-panel-month:hover,\n        .ant-calendar-year-panel-selected-cell .ant-calendar-year-panel-year:hover,\n        .ant-calendar-decade-panel-selected-cell .ant-calendar-decade-panel-decade:hover {\n          color: #fff !important;\n        }\n        .ant-input:hover,\n        .ant-input-number:hover {\n          border-color: ").concat(e," !important;\n        }\n        .ant-input:not(.main-input):focus,\n        .ant-input-number:focus,\n        .ant-input-number:active {\n          border-color: ").concat(e," !important;\n          box-shadow: 0 0 0 2px ").concat(e,"32 !important;\n        }\n        .ant-input-number-focused {\n          border-color: ").concat(e," !important;\n          box-shadow: 0 0 0 2px ").concat(e,"32 !important;\n        }\n        input:-webkit-autofill,\n        input:-webkit-autofill:hover,\n        input:-webkit-autofill:focus, {\n          background-color: ").concat(t[2]," !important;\n        }\n      "))},I=n(364),T=n(500),_=n(995),C=n(157),N=function(e){var t=e.component,n=e.layout,a=e.auth,r=void 0===a||a,o=Object(I.a)(e,["component","layout","auth"]);return s.a.createElement(T.a,Object.assign({},o,{render:function(e){return!r||r&&!0===C.a.isAuthenticated()?s.a.createElement(n,null,s.a.createElement(t,e)):s.a.createElement(_.a,{to:"/login"})}}))},D=n(2),w=n(5),j=n(10),k=n(57),P=n.n(k),R=n(11),U=n.n(R),L=n(992),B=n(76),M=n(13),F=n(48),x=n(20),H=n(162),G=n.n(H),V=n(47),q=n.n(V),W=n(220),Q=n.n(W),z=n(23),Y=n.n(z),K=n(4),X=n(17),J=n(1),Z=n(318),$=n(18),ee=(n(652),200),te={transition:"opacity ".concat(ee,"ms ease-in-out, transform ").concat(ee,"ms ease-in-out"),opacity:0,transform:"translateY(50px)"},ne=function(e,t){return"in"===e?{entering:{opacity:1,transform:"translateY(0px)"},entered:{opacity:1,transform:"translateY(0px)"},exiting:{opacity:0,transform:"translateY(12px)"},exited:{opacity:0,transform:"translateY(12px)"}}:"out"===e?{entering:{opacity:0,transform:"translateX(-12px) ".concat(t)},entered:{opacity:0,transform:"translateX(-12px) ".concat(t)},exiting:{opacity:1,transform:"translateX(0px) ".concat(t)},exited:{opacity:1,transform:"translateX(0px) ".concat(t)}}:{}},ae={transition:"opacity ".concat(ee,"ms ease-in-out, transform ").concat(ee,"ms ease-in-out"),opacity:0},re=function(e){return"in"===e?{entering:{opacity:1},entered:{opacity:1},exiting:{opacity:0},exited:{opacity:0}}:"out"===e?{entering:{opacity:0,transform:"translateX(-12px)"},entered:{opacity:0,transform:"translateX(-12px)"},exiting:{opacity:1,transform:"translateX(0px)"},exited:{opacity:1,transform:"translateX(0px)"}}:{}},oe={transition:"transform ".concat(ee,"ms ease-in-out"),transform:"translateY(40px)"},ie=function(e){return"in"===e?{entering:{opacity:1,transform:"translateY(0px)"},entered:{opacity:1,transform:"translateY(0px)"},exiting:{opacity:0,transform:"translateY(40px)"},exited:{opacity:0,transform:"translateY(40px)"}}:"out"===e?{entering:{opacity:1,transform:"translateY(40px)"},entered:{opacity:1,transform:"translateY(40px)"},exiting:{opacity:0,transform:"translateY(0px)"},exited:{opacity:0,transform:"translateY(0px)"}}:{}},se=function(e){return{transition:"background ".concat(ee,"ms ease-in-out"),backgroundSize:"100% ".concat(e)}},ce=function(e,t){return{entering:{backgroundSize:"100% ".concat(e,"px")},entered:{backgroundSize:"100% ".concat(e,"px")},exiting:{backgroundSize:"100% ".concat(t,"px")},exited:{backgroundSize:"100% ".concat(t,"px")}}},ue=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(j.a)(Object(w.a)(Object(w.a)(n)),"setLazyReady",function(){n.setState({lazyReady:!0})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"renderHomeFAQ",function(){var e=n.state.renderState,t=e.step,a=e.type,r=n.props.faqCategories;if(r=Q()(r,["order"]),0===q()(r))return null;if(q()(r)<=3){var o=q()(r);r=[].concat(Object(x.a)(G()(r,0,o-1)),[Object(D.a)({},r[o-1],{last:!0})])}else r=[].concat(Object(x.a)(G()(r,0,2)),[Object(D.a)({},r[2],{lastAndMore:!0}),{type:"show-more"}]);return s.a.createElement(L.a,{in:t>=2&&"in"===a||t>=0&&"out"===a,timeout:ee,onEntered:function(){return n.setState({renderState:Object(D.a)({},n.state.renderState,{step:t+1})})}},function(e){return s.a.createElement($.h,{style:Object(D.a)({},ae,re(a)[e]),faqCategories:r,openFAQCategories:n.openFAQCategories,openFAQList:n.openFAQList})})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"renderHome",function(){var e=b()(n.props.app,"widgetConfig.color",K.d),t=n.state.renderState,a=t.step,r=t.type,o=n.props.homeHeaderSize||180,i=0===q()(n.props.faqCategories)?2:3;return s.a.createElement("div",{style:{height:"100%",position:"relative",overflow:"hidden"},onScroll:function(e){return n.scrollHandler(e)}},s.a.createElement(L.a,{in:a>=0&&"out"===r,timeout:ee},function(t){return s.a.createElement("div",{className:"home-screen-wrapper"},s.a.createElement("div",{className:"home-screen",style:Object(D.a)({},se(o),ce(n.state.nextBackgroundSize,o)[t],{backgroundImage:"linear-gradient(".concat(e,", ").concat(e,")")})},n.renderHomeHeader(),s.a.createElement("div",{className:"home-body",ref:n.homeBodyRef},n.renderHomeConversation(),n.renderHomeFAQ())))}),s.a.createElement(L.a,{in:a>=i&&"in"===r||a>=0&&"out"===r,timeout:ee,onEntered:function(){return n.setState({renderState:Object(D.a)({},n.state.renderState,{step:a+1})})}},function(e){return s.a.createElement("div",{className:"on-customer-placeholder",style:Object(D.a)({},oe,ie(r)[e])},s.a.createElement(Z.a,{from:"home"}))}))}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"scrollHandler",function(e){var t=Math.round(e.target.scrollTop/2),a=e.target.scrollTop>=158?0:(158-e.target.scrollTop)/158;n.setState({headerScrollStyle:{opacity:a,transform:"translateY(-".concat(t,"px)")}})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"openConversations",function(){n.animateOutInto("conversations")}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"addNewConversation",function(){var e=n.props.preChatConfig;U()(b()(e,"fields"))||"clickNewConversation"!==b()(e,"settings.conditionActive")||setTimeout(function(){n.props.startPreChatSurvey()},500),n.props.initConversation(),n.animateOutInto("conversation","new")}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"openFAQCategories",function(e){n.props.faqSearchFocus(e),n.animateOutInto("faq-categories")}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"openFAQList",function(e){n.props.categorySelected({category:e}),n.animateOutInto("faq-list")}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onSelectConversation",function(e){n.props.markAsRead(e._id),n.animateOutInto("conversation","old")}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"animateOutInto",function(e,t){var a="conversations"===e?75:"faq-categories"===e?133:"conversation"===e&&"new"===t?215:"conversation"===e&&"old"===t?75:158;n.setState({renderState:{type:"out",step:-1},nextBackgroundSize:a},function(){n.setState({renderState:{type:"out",step:0}})}),setTimeout(function(){n.props.pageRedirect(e)},200)}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onToggle",function(){n.props.toggle()}),n.homeHeaderContentRef=s.a.createRef(),n.homeBodyRef=s.a.createRef(),n.state={renderState:{type:"in",step:-1},headerScrollStyle:{opacity:1,transform:"translateY(0px)"},nextBackgroundSize:158},n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"_updateHomeHeaderHeight",value:function(){var e=b()(this,"homeHeaderContentRef.current.clientHeight");if(!Y()(e)){var t,n=(t=e>=0&&e<5?85:e<25?110:e<60?130:155)+25;n!==this.cachedHomeHeaderSize&&(this.cachedHomeHeaderSize=n,this.props.setHomeHeaderSize(n),this.homeBodyRef.current.style.top="".concat(t,"px"))}}},{key:"componentDidMount",value:function(){this.props.faqSearchInput(""),this.props.faqSearchFocus(!1);var e=this;setTimeout(function(){e.setState({renderState:{type:"in",step:0}})}),this.setState({headerScrollStyle:{opacity:1,transform:"translateY(0px)"}}),this.updateHomeHeaderHeightInterval=setInterval(function(){return e._updateHomeHeaderHeight()},100),setTimeout(function(){e&&e.updateHomeHeaderHeightInterval&&clearInterval(e.updateHomeHeaderHeightInterval)},2e3)}},{key:"componentWillUnmount",value:function(){this.updateHomeHeaderHeightInterval&&clearInterval(this.updateHomeHeaderHeightInterval)}},{key:"renderHomeHeader",value:function(){var e=this,t=this.props,n=t.visitor,a=t.app,r=U()(a.description)?"":a.description,o=this.state.renderState,i=o.step,c=o.type,u=!n.nameGenerated&&n.firstName?s.a.createElement("div",{style:{width:"100%"}},A.a.t("welcome")," ",s.a.createElement("span",{className:"home-header-visitor-name"},n.firstName)," \ud83d\udc4b"):s.a.createElement("div",null,A.a.t("welcome")," ",s.a.createElement("span",{role:"img","aria-label":"wave"},"\ud83d\udc4b"));return s.a.createElement(L.a,{in:i>=0,timeout:ee,onEntered:function(){return e.setState({renderState:Object(D.a)({},e.state.renderState,{step:i+1})})}},function(t){return s.a.createElement("div",{className:"home-header",style:i<1?Object(D.a)({},te,ne(c,e.state.headerScrollStyle.transform)[t]):Object(D.a)({},e.state.headerScrollStyle)},s.a.createElement("div",{className:"home-header-title"},u),s.a.createElement("div",{className:"home-header-content",ref:e.homeHeaderContentRef,style:{WebkitBoxOrient:"vertical"}},r))})}},{key:"renderHomeConversation",value:function(){var e=this,t=this.state,n=t.lazyReady,a=t.renderState,r=a.step,o=a.type;return s.a.createElement(L.a,{in:r>=1&&n&&"in"===o||r>=0&&"out"===o,timeout:ee,onEntered:function(){return e.setState({renderState:Object(D.a)({},e.state.renderState,{step:r+1})})}},function(t){return s.a.createElement($.g,{style:Object(D.a)({},ae,re(o)[t]),agents:e.props.agents,conversations:e.props.conversations,openConversations:e.openConversations,onSelectConversation:e.onSelectConversation,addNewConversation:e.addNewConversation,setLazyReady:e.setLazyReady})})}},{key:"render",value:function(){return this.renderHome()}}]),t}(s.a.Component),de=Object(o.connect)(function(e){var t=J.a.getTable(e,J.a.tableNames.agents),n=J.a.query(t,{}),a=Object(X.g)(e),r=J.a.getTable(e,J.a.tableNames.faqCategories),o=J.a.query(r,{});return Object(D.a)({app:e.common.app},e.faq,{agents:n,homeHeaderSize:e.common.homeHeaderSize,visitor:e.auth.visitor,conversations:a,faqCategories:o,preChatConfig:e.common.preChatConfig})},function(e){return{categorySelected:function(t){e({type:K.b.FAQ_CATEGORY_SELECTED,payload:t})},pageRedirect:function(t){e({type:"PAGE_REDIRECT",payload:t})},setHomeHeaderSize:function(t){return e({type:"SET_HOME_HEADER_SIZE",payload:t})},initConversation:function(){return e(M.b.initConversation())},faqSearchInput:function(t){e({type:K.b.FAQ_SEARCH_INPUT_CHANGE,payload:t})},faqSearchFocus:function(t){e({type:K.b.FAQ_SEARCH_INPUT_FOCUS,payload:t})},markAsRead:function(t){return e(M.d.markAsRead(t))},startPreChatSurvey:function(){return e(M.e.startPreChatSurvey())}}})(ue),le=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=e.widgetOpen,n=e.unreadMessages;return!t&&U()(n)?s.a.createElement(s.a.Fragment,null):s.a.createElement("div",{className:"oc-radial-background"})}}]),t}(s.a.Component),pe=(Object(o.connect)(function(e){var t=J.a.getTable(e,J.a.tableNames.messages);return{unreadMessages:J.a.getMany(t,e.notification.unreadMessageIds),widgetOpen:e.common.widgetOpen}})(le),n(79)),ge=n.n(pe),me=n(19),fe=n.n(me),he={transition:"opacity ".concat(200,"ms ease-in-out, transform ").concat(200,"ms ease-in-out"),transform:"translateX(50px)",opacity:0},ve=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onBack",function(){var e="home"===n.props.previousPage?"".concat(n.props.homeHeaderSize,"px"):"75px";n.headerRef.current.style.height=e,n.setState({renderState:{type:"out",step:-1}},function(){n.setState({renderState:{type:"out",step:0}})}),n.props.onBack()}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"changeHeaderSize",function(e){n.props.onHeaderClick(e)}),n.state={renderState:{type:"in",step:-1},headerHeight:75},n.headerRef=s.a.createRef(),n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.setState({renderState:{type:"in",step:0},headerHeight:this.getHeight()});var e=this.props,t=e.agentFrom,n=e.agent,a=e.conversation;"lastMessage"!==t||n||this.props.loadAgent(a.lastAgentMessage.author.authorId)}},{key:"getHeight",value:function(e){var t=this.props,n=t.isHeaderMinimized,a=t.agentFrom;return(Y()(e)?n:e)?75:a?150:215}},{key:"render",value:function(){var e=this,t=this.getHeight(),n=this.state.renderState,a=n.step,r=n.type;return s.a.createElement("div",{className:"chat-header livechat theme-color-bg-non-hover",ref:this.headerRef,style:{height:"".concat(t,"px")}},s.a.createElement("div",{className:"widget-header"},s.a.createElement(L.a,{in:a>=0,timeout:200},function(t){var n=Object(D.a)({},he,function(e){return"in"===e?{entering:{opacity:1,transform:"translateX(0px)"},entered:{opacity:1,transform:"translateX(0px)"},exiting:{opacity:0,transform:"translateX(12px)"},exited:{opacity:0,transform:"translateX(12px)"}}:"out"===e?{entering:{opacity:0,transform:"translateX(12px)"},entered:{opacity:0,transform:"translateX(12px)"},exiting:{opacity:1,transform:"translateX(0px)"},exited:{opacity:1,transform:"translateX(0px)"}}:{}}(r)[t]);return s.a.createElement($.f,{style:n,unreadConversationIds:e.props.unreadConversationIds,isHeaderMinimized:e.props.isHeaderMinimized,agentFrom:e.props.agentFrom,agent:e.props.agent,app:e.props.app,conversation:e.props.conversation,agents:e.props.agents,onBack:e.onBack,changeHeaderSize:e.changeHeaderSize})})))}}]),t}(s.a.Component),be=Object(o.connect)(function(e){var t,n=J.a.getTable(e,J.a.tableNames.agents),a=J.a.query(n,{}),r=J.a.getTable(e,J.a.tableNames.conversations),o=J.a.get(r,e.conversation.conversationId),i=null;return o&&(b()(o,!1)?(t=J.a.get(n,o.lastAgentMessage.author.authorId),i="lastMessage"):o.assigned&&(t=o.assigned,i="assigned")),Object(D.a)({app:e.common.app,appName:e.common.appName,agents:a,agent:t,agentFrom:i,unreadConversationIds:e.notification.unreadConversationIds,breadCrumbs:e.common.breadCrumbs,previousPage:e.common.previousPage},e.conversation,{conversation:o,homeHeaderSize:e.common.homeHeaderSize})},function(e){return{pageBack:function(t){e({type:"PAGE_BACK",payload:t})},loadAgent:function(t){return e(M.e.loadAgent(t))}}},null,{withRef:!0})(ve),ye=n(159),Ee={transition:"opacity ".concat(200,"ms ease-in-out, transform ").concat(200,"ms ease-in-out, height ").concat(200,"ms ease-in-out"),transform:"translateX(50px)",opacity:0},Ae=function(e){return"in"===e?{entering:{opacity:1,transform:"translateX(0px)"},entered:{opacity:1,transform:"translateX(0px)"},exiting:{opacity:0,transform:"translateX(12px)"},exited:{opacity:0,transform:"translateX(12px)"}}:"out"===e?{entering:{opacity:0,transform:"translateX(12px)"},entered:{opacity:0,transform:"translateX(12px)"},exiting:{opacity:1,transform:"translateX(0px)"},exited:{opacity:1,transform:"translateX(0px)"}}:{}},Oe=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(j.a)(Object(w.a)(Object(w.a)(n)),"setLazyReady",function(){n.setState({lazyReady:!0})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"handleScroll",function(e){"INPUT"!==document.activeElement.tagName&&(n.checkScrollAtBottom(n.listConvElm)?n.props.scrollAtBottom||n.props.updateScrollAtBottom(!0):n.props.scrollAtBottom&&n.props.updateScrollAtBottom(!1),0===e.target.scrollTop&&!n.props.messagesLoading&&n.props.hasMoreMessages&&n.props.conversation&&!n.props.conversation.isClientSide&&n.props.loadMessages(n.props.conversationId,n.props.lastTimestamp))}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"wheelHandler",function(e){var t=!(n.listConvElm.scrollTop<100&&!n.props.hasMoreMessages)||e.deltaY>0;t!==n.state.isHeaderMinimized&&n.setState({isHeaderMinimized:t})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onBack",function(){var e=Object(X.h)();n.listConvElm.style.height="".concat(e-n.props.homeHeaderSize,"px"),n.setState({renderState:{type:"out",step:-1}},function(){n.setState({renderState:{type:"out",step:0}})}),setTimeout(function(){n.props.pageBack()},200)}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onAddNew",function(){n.props.clearWidget(),n.props.initConversation()}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"onHeaderClick",function(e){"minimize"===e?n.setState({isHeaderMinimized:!0}):"maximize"===e&&n.setState({isHeaderMinimized:!1})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"updateInputHeight",function(e){n.setState({inputHeight:e})}),Object(j.a)(Object(w.a)(Object(w.a)(n)),"getChatContentHeight",function(){var e=n.state.inputHeight||60,t=n.headerRef.current?n.headerRef.current.getWrappedInstance().getHeight(n.state.isHeaderMinimized):n.state.isHeaderMinimized?75:215;return"calc(100% - ".concat(t+e,"px)")}),n.listConvElm=s.a.createRef(),n.state={isHeaderMinimized:!Y()(n.props.conversationId),renderState:{type:"in",step:-1}},n.send=n.send.bind(Object(w.a)(Object(w.a)(n))),n.sendImage=n.sendImage.bind(Object(w.a)(Object(w.a)(n))),n.scrollToBottom=n.scrollToBottom.bind(Object(w.a)(Object(w.a)(n))),n.headerRef=s.a.createRef(),n.onTyping=n.onTyping.bind(Object(w.a)(Object(w.a)(n))),n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.setState({renderState:{type:"in",step:0}});var e=this.props,t=e.conversation,n=e.loadMessages;t&&(t.isClientSide?this.props.loadClientMessages(t._id):n(t._id)),X.c.hasAnswerBot(this.props.app)&&this.props.loadAllFAQs()}},{key:"componentWillUnmount",value:function(){this.props.clearWidget()}},{key:"send",value:function(e){var t=this.props,n=t.preChatConfig;if(!t.isBotRunning&&!U()(b()(n,"fields"))&&"default"===b()(n,"settings.conditionActive"))return this.props.startPreChatSurvey(),!1;var a=X.c.convertEmoticonToEmoji(e);return this.props.sendText(this.props.conversationId,this.props.conversationAssignedUUID,a),this.afterSend(),!0}},{key:"afterSend",value:function(){this.setState({isHeaderMinimized:!0}),this.scrollToBottom()}},{key:"sendImage",value:function(e,t){var n=this.props,a=n.preChatConfig;if(!n.isBotRunning&&!U()(b()(a,"fields"))&&"default"===b()(a,"settings.conditionActive"))return this.props.startPreChatSurvey();this.props.sendImage(this.props.conversationId,this.props.conversationAssignedUUID,e,t),this.afterSend()}},{key:"componentDidUpdate",value:function(e,t,n){this._checkScroll(n,e)}},{key:"_checkScroll",value:function(e,t){this.listConvElm&&(this.props.scrollAtBottom||this.checkScrollAtBottom(this.listConvElm,e)?this.scrollToBottom():Y()(e)||this.listConvElm.scrollHeight!==e.oldScrollHeight&&t.messagesLoading!==this.props.messagesLoading&&(this.listConvElm.scrollTop+=this.listConvElm.scrollHeight-e.oldScrollHeight))}},{key:"checkScrollAtBottom",value:function(e,t){if(Y()(e))return!1;var n=e.scrollHeight-e.scrollTop-e.clientHeight<5,a=t&&t.oldScrollHeight-t.oldScrollTop-t.oldClientHeight<5;return n||a}},{key:"scrollToBottom",value:function(e){this.messagesEnd&&this.messagesEnd.scrollIntoView(e)}},{key:"getSnapshotBeforeUpdate",value:function(e,t){return{oldScrollHeight:this.listConvElm.scrollHeight,oldScrollTop:this.listConvElm.scrollTop,oldClientHeight:this.listConvElm.clientHeight}}},{key:"onTyping",value:function(e){if(X.c.hasAnswerBot(this.props.app)){var t=M.c.searchFaqs(this.props.faqs,e);this.setState({suggestedAnswers:fe()(t,function(e){return ge()(e,["title"])})})}}},{key:"render",value:function(){var e=this,t=this.state.renderState,n=t.step,a=t.type,r=this.getChatContentHeight(),o=this.state.lazyReady&&n>=0;return s.a.createElement("div",{className:"conversation",onWheel:function(t){return e.wheelHandler(t)}},s.a.createElement("div",{className:"chat-main-frame"},s.a.createElement(be,{isHeaderMinimized:this.state.isHeaderMinimized,onBack:this.onBack,ref:this.headerRef,onHeaderClick:this.onHeaderClick}),s.a.createElement("div",{className:"loading-animation"},this.props.messagesLoading?s.a.createElement(ye.a,null):null),s.a.createElement(L.a,{in:o,timeout:200},function(t){var n=Object(D.a)({},Ee,Ae(a)[t],{height:r,transition:"opacity ".concat(200,"ms ease-in-out, transform ").concat(200,"ms ease-in-out")});return s.a.createElement($.j,{style:n,handleScroll:e.handleScroll,messages:e.props.messages,messagesBeingSent:e.props.messagesBeingSent,messagesFailed:e.props.messagesFailed,conversation:e.props.conversation,sendCSATRate:e.props.sendCSATRate,sendCSATFeedback:e.props.sendCSATFeedback,getListConvElm:function(t){return e.listConvElm=t},getMessagesEnd:function(t){return e.messagesEnd=t},setLazyReady:e.setLazyReady})}),s.a.createElement(L.a,{in:o,timeout:200},function(t){return s.a.createElement($.i,{className:"input-box",send:e.send.bind(e),sendImage:e.sendImage,dontAutoFocus:!e.props.conversationId&&X.c.isOnMobile(),onTyping:e.onTyping,scrollToBottom:e.scrollToBottom,suggestedAnswers:e.state.suggestedAnswers,updateInputHeight:e.updateInputHeight,animationStyle:Object(D.a)({},Ee,Ae(a)[t])})})))}}]),t}(s.a.Component),Se=Object(o.connect)(function(e){var t=e.conversation.conversationId,n=J.a.getTable(e,J.a.tableNames.messages),a=J.a.getMany(n,e.conversation.messageIds),r=J.a.getTable(e,J.a.tableNames.conversations),o=J.a.get(r,t),i=b()(o,"meta.botInfo.runId"),s=b()(e,"bot.runningBots.".concat(i)),c=!!s&&!b()(s,"completed",!1),u=J.a.getTable(e,J.a.tableNames.faqs),d=J.a.query(u,{});return Object(D.a)({},e.conversation,{messages:a,faqs:d,app:e.common.app,notification:e.notification,previousPage:e.common.previousPage,adminIsTyping:e.conversation.adminIsTyping,conversation:o,homeHeaderSize:e.common.homeHeaderSize,isPreChatSurveyLoaded:e.common.isPreChatSurveyLoaded,preChatConfig:e.common.preChatConfig,isBotRunning:c})},function(e){return{sendText:function(t,n,a){return M.d.sendText(t,n,a)(e)},sendImage:P()(e,M.d.sendImage),loadMessages:function(t,n){return e(M.d.loadMessages(t,n))},clearWidget:function(){return e({type:"CONVERSATION_CLEAR"})},sendCSATRate:function(t){M.b.ratingConversation(t)(e)},sendCSATFeedback:function(t){M.b.feedbackConversation(t)(e)},pageBack:function(t){e({type:"PAGE_BACK",payload:t})},loadClientMessages:function(t){return e(M.d.loadClientMessages(t))},updateScrollAtBottom:function(t){return e({type:"SCROLL_AT_BOTTOM_CHANGED",payload:{scrollAtBottom:t}})},initConversation:function(){return e(M.b.initConversation())},startPreChatSurvey:function(){return e(M.e.startPreChatSurvey())},loadAllFAQs:function(){return e(M.c.loadAllFAQs())}}})(Oe),Ie={entering:{opacity:0,transform:"translateY(20px)"},entered:{opacity:0,transform:"translateY(20px)"},exiting:{opacity:1,transform:"translateY(0px)"},exited:{opacity:1,transform:"translateY(0px)"}},Te=function(e){function t(e){var n;return Object(p.a)(this,t),n=Object(m.a)(this,Object(f.a)(t).call(this,e)),Object(j.a)(Object(w.a)(Object(w.a)(n)),"scrollHandler",function(e){e.target.scrollTop>100&&"home"===n.props.currentPage?n.setState({btnCloseClass:"btn-dark"}):n.setState({btnCloseClass:""})}),n.state={renderStep:-1,btnCloseClass:"",wrapperInnerStyle:{transition:"transform 0.3s ease-in-out, opacity 0.3s ease-in-out"},wrapperInnerClass:""},n.toggle=n.toggle.bind(Object(w.a)(Object(w.a)(n))),n}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.isPreChatSurveyLoaded||this.props.getPreChatSurvey()}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.currentPage!==e.currentPage&&"home"!==this.props.currentPage&&this.setState({btnCloseClass:""}),this.props.widgetOpen===e.widgetOpen||this.props.widgetOpen||this.setState({renderStep:-1}),this.props.isWidgetExpanded!==e.isWidgetExpanded){var n=this.props.isWidgetExpanded?"chat-wrapper-inner-expanded":"";this.setState({wrapperInnerStyle:{transition:"width 0.3s ease-in-out, transform 0.3s ease-in-out, opacity 0.3s ease-in-out"},wrapperInnerClass:n},function(){setTimeout(function(){t.setState({wrapperInnerStyle:{transition:"transform 0.3s ease-in-out, opacity 0.3s ease-in-out"}})},300)})}}},{key:"renderContent",value:function(){switch(this.props.currentPage){case"home":return s.a.createElement(de,null);case"conversations":return s.a.createElement($.a,null);case"conversation":return s.a.createElement(Se,null);case"faq-categories":return s.a.createElement($.c,null);case"faq-list":return s.a.createElement($.e,null);case"faq-detail":return s.a.createElement($.d,null);default:return s.a.createElement(de,null)}}},{key:"toggle",value:function(){var e=this;this.props.closePreChatSurvey(),this.props.initialized&&(this.props.widgetOpen?(this.setState({renderStep:0}),setTimeout(function(){e.props.changeWidgetWidth(!1),Object(B.j)("oc-shrink"),e.props.toggle()},200)):(this.setState({renderStep:-1}),this.props.changeWidgetWidth(!1),Object(B.j)("oc-shrink"),this.props.toggle()))}},{key:"renderIcon",value:function(){var e=this.props.app,t=b()(e,"widgetConfig.icon");return U()(t)?s.a.createElement("div",{className:"icon show-widget"}):s.a.createElement("div",{className:"icon show-widget",style:{backgroundImage:"url(".concat(t,")")}})}},{key:"renderNotification",value:function(){return this.props.widgetOpen?null:s.a.createElement("div",{onMouseEnter:function(){return Object($.o)(["Conversation"])}},s.a.createElement($.l,null))}},{key:"render",value:function(){var e=this,t=this.props,n=t.widgetOpen,a=t.initialized,r=t.isPreChatSurveyOpened,o=!b()(F.a.getSettings(),"custom_launcher_selector");return s.a.createElement("div",{className:"chat-wrapper state-"+(n?"1":"0")},this.renderNotification(),o?s.a.createElement("div",{id:"btn-start-chat",className:"btn-start-chat theme-color-bg-non-hover "+(n?"":"appear"),onClick:this.toggle,onMouseEnter:function(){return Object($.o)(["Conversation"])}},this.renderIcon()):null,n?s.a.createElement(L.a,{in:this.state.renderStep>=0,timeout:200},function(t){return s.a.createElement("div",{className:"chat-wrapper-inner ".concat(e.state.wrapperInnerClass),onScroll:function(t){return e.scrollHandler(t)},style:Object(D.a)({},e.state.wrapperInnerStyle,Ie[t])},s.a.createElement(i.Fragment,null,s.a.createElement("div",{className:"chat-close-wrapper"},s.a.createElement(L.a,{in:e.state.renderStep>=0,timeout:200},function(t){return s.a.createElement("button",{style:Object(D.a)({},Ie[t],{display:n?"block":"none"}),className:"chat-close-button",onClick:e.toggle},s.a.createElement("img",{alt:"",src:"/images/icon-close.svg",width:9}))})),s.a.createElement("div",{className:"btn-close-mobile ".concat(e.state.btnCloseClass),onClick:e.toggle},s.a.createElement("img",{alt:"",src:"/images/icon-close.svg"})),a?e.renderContent():null,r&&s.a.createElement($.m,null)))}):null)}}]),t}(s.a.Component),_e=Object(o.connect)(function(e){return{currentPage:e.common.currentPage,app:e.common.app,widgetOpen:e.common.widgetOpen,initialized:e.common.initialized,isWidgetExpanded:e.common.isWidgetExpanded,isPreChatSurveyOpened:e.common.isPreChatSurveyOpened,isPreChatSurveyLoaded:e.common.isPreChatSurveyLoaded}},function(e){return{toggle:P()(e,M.a.toggle),changeWidgetWidth:function(t){e({type:"WIDGET_WIDTH_CHANGED",payload:t})},getPreChatSurvey:function(){return e(M.e.getPreChatSurvey())},closePreChatSurvey:function(){return e(M.e.closePreChatSurvey())}}})(Te),Ce=n(41),Ne=(n(654),function(e){var t=e.children;return s.a.createElement("div",null,t)}),De=n(362),we=n(363);n(656);var je=n(657),ke=n(658),Pe={en:{translation:De},vi:{translation:we}};A.a.init({resources:Pe,lng:Ce.a.getLanguage()}),E.a.extend(ke).extend(je),E.a.locale(Ce.a.getLanguage()),E.a.updateLocale("vi",{relativeTime:{future:"m\u1edbi \u0111\xe2y",past:"%s",s:"m\u1edbi \u0111\xe2y",m:"1 ph\xfat tr\u01b0\u1edbc",mm:"%d ph\xfat tr\u01b0\u1edbc",h:"1 gi\u1edd tr\u01b0\u1edbc",hh:"%d gi\u1edd tr\u01b0\u1edbc",d:"1 ng\xe0y tr\u01b0\u1edbc",dd:"%d ng\xe0y tr\u01b0\u1edbc",M:"1 th\xe1ng tr\u01b0\u1edbc",MM:"%d th\xe1ng tr\u01b0\u1edbc",y:"1 n\u0103m tr\u01b0\u1edbc",yy:"%d n\u0103m tr\u01b0\u1edbc"}});var Re=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){this.props.onLoad()}},{key:"render",value:function(){if(this.props.appLoaded){var e=this.props.app,t=b()(e,"widgetConfig.color",K.d),n=b()(e,"widgetConfig.size","large"),a=b()(e,"widgetConfig.theme",1),r=b()(e,"widgetConfig.placement","right");return s.a.createElement("div",{className:"main size-"+n+" theme-number-"+a+" placement-"+r},S(t),s.a.createElement(u.a,null,s.a.createElement(N,{path:"/livechat",component:_e,layout:Ne,auth:!1}),s.a.createElement(N,{path:"/notification",component:$.k,layout:Ne,auth:!1})))}return s.a.createElement("div",null)}}]),t}(s.a.Component),Ue=Object(o.connect)(function(e){return{app:e.common.app,appLoaded:e.common.appLoaded}},function(e){return{onLoad:function(){e(M.a.started()),M.a.init()(e)}}})(Re),Le=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){return s.a.createElement(u.a,null,s.a.createElement(N,{path:"/visual-selection",component:$.n,layout:Ne,auth:!1}),s.a.createElement(N,{component:Ue,layout:Ne,auth:!1}))}}]),t}(s.a.Component);r.a.render(s.a.createElement(o.Provider,{store:c.b},s.a.createElement(l.a,{history:c.a},s.a.createElement(u.a,null,s.a.createElement(d.a,{path:"/",component:Le})))),document.getElementById("root"))},7:function(e,t,n){"use strict";var a=n(3),r=n.n(a),o=n(346),i=n.n(o),s=n(29),c=n(6),u=n(48),d=n(222),l={sendMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.location||(e.location=u.a.getLocation());return c.a.requests.post("/livechat/conversation",e)},reply:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(e=i()(e)).conversationId)return Promise.resolve();e.location||(e.location=u.a.getLocation());var t=e.conversationId;return delete e.conversationId,c.a.requests.post("/livechat/conversation/"+t+"/user-reply",e)},getShortFromMessage:function(e){var t=r()(e,"blocks[0]");if(!t)return{content:""};switch(Object(d.c)(t.contentType)){case"image":return{content:s.a.t("Tin nh\u1eafn h\xecnh \u1ea3nh"),isFromSystem:!0};case"video":return{content:s.a.t("Tin nh\u1eafn video"),isFromSystem:!0};case"file":return{content:s.a.t("Tin nh\u1eafn file \u0111\xednh k\xe8m"),isFromSystem:!0};default:return{content:t.content}}},getByConversation:function(e,t){var n="livechat/conversation/"+e+"/messages";t&&(n+="?lastTimestamp="+t);return c.a.requests.get(n)},uploadFile:function(e,t,n){var a=new FormData;return a.append("file",t),c.a.requests.post("/user/file-upload",a,n)},getUnreadMessages:function(){return c.a.requests.get("livechat/message/unread")},newBotConversation:function(e,t,n,a){return c.a.requests.post("/livechat/bot-conversation",{botMessages:t,message:n,botId:e,options:a})}};var p=n(41),g={getAuthor:function(){var e=function(){if(!p.a.getToken())return;return c.a.getVisitor()}();return{firstName:e.firstName,lastName:e.lastName,name:"".concat(e.lastName," ").concat(e.firstName),type:"visitor",authorId:e._id}},saveVisitor:function(e,t){var n=p.a.getToken();if(!n)return;c.a.saveVisitor(n,e,t)},voteFAQ:function(e,t){return c.a.requests.patch("user/visitor/vote/".concat(t),{action:e||""})},getAgent:function(e){return c.a.requests.get("user/widget/agent/".concat(e))},isLoggedInUser:function(e){return e.userId},updateVisitorByBot:function(e){return c.a.requests.patch("/user/visitor/update-by-bot",e)},getPreChatSurvey:function(e){if(!e)return Promise.resolve();return c.a.requests.get("user/widget/pre-chat-survey/".concat(e))},submitPreChatSurvey:function(e,t){return c.a.requests.patch("user/widget/pre-chat-survey/".concat(e),t)},getAllCustomFields:function(){return c.a.requests.get("/user/custom-fields")},finishOnPageScore:function(e){return c.a.requests.post("user/widget/finish-on-page/".concat(e))}};var m={getAll:function(){var e="/livechat/app/"+p.a.getToken();return c.a.requests.get(e).then(function(e){return e}).catch(function(e){})},getById:function(e){var t="/livechat/conversation/"+e;return c.a.requests.get(t).then(function(e){return e}).catch(function(e){})},read:function(e){return c.a.requests.patch("/livechat/conversation/user-read",{conversationId:e})},ratingConversation:function(e){return c.a.requests.post("livechat/conversation/csat-rating",e)},feedbackConversation:function(e){return c.a.requests.post("livechat/conversation/csat-feedback",e)}};var f={getAll:function(){return c.a.requests.get("user/faq-categories").then(function(e){return e}).catch(function(e){})},getByCategory:function(e){var t="user/faqs/by-category/"+e;return c.a.requests.get(t).then(function(e){return e}).catch(function(e){})},getAllFAQs:function(){return c.a.requests.get("user/widget/faqs").then(function(e){return e}).catch(function(e){})},getVotedFAQs:function(){return c.a.requests.get("/user/faqs/voted")}};var h={trigger:function(e){return c.a.requests.post("user/campaign/".concat(e._id,"/trigger"))}};var v=n(77),b=n(2),y=n(40),E=n.n(y),A=n(359),O=n.n(A),S=n(360),I=n.n(S),T=n(15),_=n.n(T),C=n(9),N=n(17),D=n(74);var w={isConditionSatisfied:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"or":return!!_()(t.conditions,function(t){return e(t,n)});case"and":return!_()(t.conditions,function(t){return!e(t,n)});default:return function(e,t){var n=C.b.getState();switch(e.attribute){case"url":return function(e,t){var n=e.value;switch(e.comparison){case"unknown":return!t;case"eq":return t===n;case"neq":return t!==n;case"startWith":return I()(t,n);case"endWith":return O()(t,n);case"contains":return E()(t,n);case"notContains":return!E()(t,n);case"known":return!!t;default:return!1}}(Object(b.a)({},e,{value:Object(N.l)(e.value)}),Object(N.l)(u.a.getLocation().url));case"presenceDuration":var a=Date.now()-n.common.widgetStartedAt;return 1e3*e.value<a;case"hover":return function(e,t){return!!t.hover}(0,t);case"click":return function(e,t){return!!t.click}(0,t);case"scroll":return function(e,t){return!!t.scroll}(0,t);case"inactiveVisitor":return!r()(n,"parentDocument.isParentActive")&&r()(n,"parentDocument.lastParentInactiveSince")&&Date.now()-n.parentDocument.lastParentInactiveSince>D.e;default:return!1}}(t,n)}}};n.d(t,"h",function(){return l}),n.d(t,"i",function(){return g}),n.d(t,"g",function(){return u.a}),n.d(t,"a",function(){return p.a}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return f}),n.d(t,"b",function(){return h}),n.d(t,"f",function(){return v.a}),n.d(t,"c",function(){return w})},74:function(e,t,n){"use strict";n.d(t,"j",function(){return i}),n.d(t,"i",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"g",function(){return g}),n.d(t,"d",function(){return p}),n.d(t,"h",function(){return m}),n.d(t,"e",function(){return f}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return u});var a=n(95),r=n.n(a),o=n(29),i=[".png",".jpg",".jpeg"],s=[".doc",".docx",".pdf",".xls",".xlsx",".ppt",".pptx",".mp4",".mkv",".zip"],c=36700160,u={NAME:"appName",AGENT_NAME:"agentName",AGENT_FULLNAME:"agentFullname"},d=r()([{field:"name",title:"H\u1ecd v\xe0 T\xean",resourceType:"user",type:"string",icon:"/images/field/icon-email.svg"},{field:"online",title:"Tr\u1ea1ng th\xe1i online",resourceType:"user",type:"boolean",icon:"/images/field/icon-time.png"},{field:"label",title:"Tag",resourceType:"user",type:"label",icon:"/images/icon-label-gray.svg"}],[{field:"appName",title:"T\xean \u1ee9ng d\u1ee5ng"},{field:"agentName",title:"T\xean ng\u01b0\u1eddi g\u1eedi"},{field:"agentFullname",title:"H\u1ecd v\xe0 t\xean ng\u01b0\u1eddi g\u1eedi"},{field:"email",title:"Email",icon:"/images/field/icon-email.svg",type:"string",editable:!0,resourceType:"user",editableConfig:{placeHolder:"Nh\u1eadp email",key:"email"}},{field:"phone",title:"\u0110i\u1ec7n tho\u1ea1i",type:"string",icon:"/images/field/icon-phone.png",editable:!0,resourceType:"user",editableConfig:{placeHolder:"0987 xxx xxx",key:"phone"}},{field:"userId",title:"User Id",type:"string",resourceType:"user",icon:"/images/field/icon-user.png"},{field:"createdAt",title:"L\u1ea7n \u0111\u1ea7u online",resourceType:"user",type:"date",icon:"/images/field/icon-time.png"},{field:"ip",title:"\u0110\u1ecba ch\u1ec9 IP",type:"string",resourceType:"user",icon:"/images/field/icon-browser.png"},{field:"lastSeen",title:"L\u1ea7n cu\u1ed1i online",type:"date",resourceType:"user",icon:"/images/field/icon-time.png"},{field:"totalSessions",title:"S\u1ed1 l\u1ea7n xem trang",resourceType:"user",type:"number",icon:"/images/field/icon-session.png"},{field:"firstContactedAt",title:"Li\xean h\u1ec7 \u0111\u1ea7u",resourceType:"user",type:"date",icon:"/images/field/icon-time.png"},{field:"lastHeard",title:"Li\xean h\u1ec7 cu\u1ed1i",resourceType:"user",type:"date",icon:"/images/field/icon-time.png"},{field:"geoLocation.country",type:"string",resourceType:"user",title:"Qu\u1ed1c gia",icon:"/images/field/icon-location.svg"},{field:"geoLocation.city",title:"T\u1ec9nh th\xe0nh",resourceType:"user",type:"string",icon:"/images/field/icon-location.svg"},{field:"utmCampaign",title:"Utm Campaign",type:"string",resourceType:"user",icon:"/images/field/icon-campaign.png"},{field:"utmSource",title:"Utm Source",type:"string",resourceType:"user",icon:"/images/field/icon-campaign.png"},{field:"utmContent",title:"Utm Content",type:"string",resourceType:"user",icon:"/images/field/icon-campaign.png"},{field:"utmTerm",title:"Utm Term",type:"string",resourceType:"user",icon:"/images/field/icon-campaign.png"},{field:"utmMedium",title:"Utm Medium",type:"string",resourceType:"user",icon:"/images/field/icon-campaign.png"},{field:"deviceWebMeta.browser",title:"Tr\xecnh duy\u1ec7t",type:"string",resourceType:"user",icon:"/images/field/icon-browser.png"},{field:"deviceWebMeta.browserVersion",title:"Version tr\xecnh duy\u1ec7t",type:"string",resourceType:"user",icon:"/images/field/icon-setting.png"},{field:"deviceWebMeta.device",title:"Thi\u1ebft b\u1ecb",type:"string",resourceType:"user",icon:"/images/field/icon-device.png"},{field:"deviceWebMeta.os",title:"H\u1ec7 \u0111i\u1ec1u h\xe0nh",type:"string",resourceType:"user",icon:"/images/field/icon-os.png"},{field:"deviceWebMeta.browserLanguage",title:"Ng\xf4n ng\u1eef tr\xecnh duy\u1ec7t",type:"string",resourceType:"user",icon:"/images/field/icon-language.png"}]),l=[{icon:"/images/angry.svg",value:"1",title:o.a.t("Gi\u1eadn d\u1eef")},{icon:"/images/sad.svg",value:"2",title:o.a.t("Th\u1ea5t v\u1ecdng")},{icon:"/images/meh.svg",value:"3",title:o.a.t("T\u1ea1m \u1ed5n")},{icon:"/images/smile.svg",value:"4",title:o.a.t("T\u1ed1t")},{icon:"/images/excited.svg",value:"5",title:o.a.t("Tuy\u1ec7t v\u1eddi")}],p=5,g={ADMIN_IS_TYPING:"AdminIsTyping",VISITOR_IS_TYPING:"UserIsTyping"},m={visitor:[!1,!0]},f=3e3},76:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"j",function(){return i}),n.d(t,"f",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return g}),n.d(t,"d",function(){return m});var a=n(97),r=n.n(a),o=function(e,t){window.parent.postMessage({method:"oc-chat-widget-change-height",className:e,contextData:t},"*")},i=function(e){window.parent.postMessage({method:"oc-chat-widget-toggle-reading-size",className:e},"*")},s=function(e){window.parent.postMessage(r()(e,{method:"oc-chat-widget-notif-new-message"}),"*")},c=function(){window.parent.postMessage({method:"close-notif"},"*")},u=function(){window.parent.postMessage({method:"closeWidget"},"*")},d=function(){window.parent.postMessage({method:"oc-escape-pressed"},"*")},l=function(e){window.parent.postMessage({method:"oc-show-overlay-image",url:e},"*")},p=function(){window.parent.postMessage({method:"hidden-widget"})},g=function(e,t){window.parent.postMessage({method:e,data:t},"*")},m=function(){return document.getElementsByClassName("chat-wrapper-inner")[0].getBoundingClientRect().height}},77:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var a,r,o=n(2),i=n(347),s=n.n(i),c=n(42),u=n.n(c),d=n(157),l=(n(209),n(48)),p=n(17),g=!1;function m(e){a?e&&e(a):setTimeout(function(){m(e)},100)}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m(function(t){t.emit(e.eventName,e)})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;m(function(n){var a=p.c.getDomainFromUrl(e.referrer),r=p.c.getDomainFromUrl(e.url),i={utm_campaign:"utmCampaign",utm_content:"utmContent",utm_medium:"utmMedium",utm_source:"utmSource",utm_term:"utmTerm"},s={},c=new URLSearchParams(e.search);Object.keys(i).forEach(function(e){var t=c.get(e);t&&(s[i[e]]=t)}),n.emit("UserPresence",{eventName:"UserPresence",eventData:Object(o.a)({},e,s,{referrerDomain:a,urlDomain:r,isNew:t})})})}var v={initSocket:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a||((a=s.a.connect(u.a.SOCKET.SERVER,{query:"token=".concat(d.a.getToken(),"&appId=").concat(e._id),reconnection:!0,transports:["websocket"],allowUpgrades:!1})).on("connect",function(){g||(g=!0,h(l.a.getLocation(!0),t.isNew),r&&clearInterval(r),r=setInterval(function(){f({eventName:"live:ping"})},u.a.LIVE.PING_INTERVAL))}),a)},getSocketId:function(){if(a)return a.id},sendToServer:f,userVisitPage:h}},9:function(e,t,n){"use strict";var a=n(78),r=(n(411),n(337)),o=n(338),i=n(3),s=n.n(i),c=n(6),u=n(4),d=function(e){return function(t){return function(n){if((o=n.payload)&&"function"===typeof o.then){e.dispatch({type:"ASYNC_START",subtype:n.type});var a=e.getState().viewChangeCounter,r=n.skipTracking;n.payload.then(function(t){var o=e.getState();(r||o.viewChangeCounter===a)&&(n.payload=t,e.dispatch({type:"ASYNC_END",promise:n.payload}),e.dispatch(n))},function(t){var o=e.getState();(r||o.viewChangeCounter===a)&&(n.error=!0,n.payload=s()(t,"response.body"),n.skipTracking||e.dispatch({type:"ASYNC_END",promise:n.payload}),e.dispatch(n))})}else{var o;t(n)}}}},l=function(e){return function(e){return function(t){t.type===u.b.APP_LOAD&&c.a.setApp(t.payload),e(t)}}};var p=n(2),g=n(20),m=n(36),f=n.n(m),h=n(11),v=n.n(h),b=n(115),y=n.n(b),E=n(47),A=n.n(E),O=n(118),S=n.n(O),I={currentPage:"home",breadCrumbs:[{page:"home"}],widgetOpen:!1,isWidgetExpanded:!1,isFAQsLoaded:!1,isPreChatSurveyLoaded:!1,preChatConfig:{},isPreChatSurveyOpened:!1},T=n(19),_=n.n(T),C=n(34),N=n.n(C),D=n(15),w=n.n(D),j=n(100),k=n.n(j),P=n(16),R=n.n(P),U={messageIds:[],messagesBeingSent:[],messagesFailed:[],scrollAtBottom:!0},L=n(40),B=n.n(L),M=n(10),F=n(119),x=n.n(F),H=n(1),G=n(98),V=Object(a.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.f.GET_INFO_USER:return Object(p.a)({},e,{visitor:t.payload});case u.f.VOTED:var n=e.visitor.voted||[],a=e.visitor.downVoted||[],r=t.payload,o=r.data,i=r.faqId;"voted"===o?(n.push({faq:i}),a=a.filter(function(e){return e.faq!==i})):"downVoted"===o?(a.push({faq:i}),n=n.filter(function(e){return e.faq!==i})):(n=n.filter(function(e){return e.faq!==i}),a=a.filter(function(e){return e.faq!==i}));var s=Object(p.a)({},e.visitor,{voted:n,downVoted:a});return Object(p.a)({},e,{visitor:s});case"VISITOR_UPDATED":return Object(p.a)({},e,{visitor:Object(p.a)({},e.visitor,t.payload)});default:return e}},common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"WIDGET_STARTED":return Object(p.a)({},e,{widgetStartedAt:Date.now(),isParentActive:!0,lastParentActiveSince:Date.now()});case"APP_LOAD":return Object(p.a)({},e,{appLoaded:!0,app:t.payload?t.payload:null,conversations:t.payload?t.payload.conversations:[]});case"WIDGET_TOGGLED":var n=t.payload.breadCrumbsUpdates;return n||(n=e.widgetOpen?{currentPage:"home",breadCrumbs:[{page:"home"}]}:null),Object(p.a)({},e,{widgetOpen:t.payload.widgetOpen||!e.widgetOpen},n);case"SET_HOME_HEADER_SIZE":return Object(p.a)({},e,{homeHeaderSize:t.payload});case"APP_MAIN_DATA_LOADING":return Object(p.a)({},e,{mainLoading:!0});case"APP_MAIN_DATA_LOADED":return Object(p.a)({},e,{mainLoading:!1,mainLoaded:!0});case"APP_INITIALIZED":return Object(p.a)({},e,{initialized:!0});case"PAGE_REDIRECT":var a=[].concat(Object(g.a)(e.breadCrumbs),[{page:t.payload}]);return Object(p.a)({},e,{currentPage:t.payload,breadCrumbs:a,previousPage:s()(S()(a,A()(a)-2),"page")||"home"});case"PAGE_BACK":var r=Object(g.a)(e.breadCrumbs),o=r.pop();return Object(p.a)({},e,{currentPage:s()(y()(r),"page")||"home",breadCrumbs:v()(r)?[{page:"home"}]:r,previousPage:s()(o,"page")||"home"});case"WIDGET_WIDTH_CHANGED":return Object(p.a)({},e,{isWidgetExpanded:t.payload});case"ALL_FAQS_LOADED":return Object(p.a)({},e,{isFAQsLoaded:!0});case u.b.CUSTOM_BOT_SIMULATION_INIT:return Object(p.a)({},e,{isSimulating:!0});case"PRECHAT_SURVEY_LOADED":return Object(p.a)({},e,{isPreChatSurveyLoaded:!0,preChatConfig:t.payload.preChatConfig});case"PRECHAT_SURVEY_STARTED":return Object(p.a)({},e,{isPreChatSurveyOpened:!0,preChatConfig:t.payload.preChatConfig});case"PRECHAT_SURVEY_CLOSED":return Object(p.a)({},e,{isPreChatSurveyOpened:!1});case"PRECHAT_SURVEY_SUBMITTED":return Object(p.a)({},e,{preChatConfig:Object(p.a)({},e.preChatConfig,{fields:t.payload})});case"FLOW_ON_PAGE_STATE_LOADED":return Object(p.a)({},e,{flowOnPageStates:t.payload});case"FLOW_ON_PAGE_STATE_APPENDED":return Object(p.a)({},e,{flowOnPageStates:[].concat(Object(g.a)(e.flowOnPageStates),[t.payload])});case"FLOW_ON_PAGE_STATE_REMOVED":return Object(p.a)({},e,{flowOnPageStates:f()(e.flowOnPageStates,function(e){return e._id===t.payload._id&&e.flowId===t.payload.flowId})});default:return e}},conversation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONVERSATION_ADMIN_IS_TYPING":return s()(t,"payload.conversation._id")!==e.conversationId&&s()(t,"payload.conversation.conversationAssignedUUID")!==e.conversationAssignedUUID?e:Object(p.a)({},e,{adminIsTyping:!0});case"CONVERSATION_ADMIN_STOPS_TYPING":return s()(t,"payload.conversation._id")!==e.conversationId?e:Object(p.a)({},e,{adminIsTyping:!1});case"CONVERSATION_INIT":return Object(p.a)({},e,{conversationAssignedUUID:R()(),hasMoreMessages:!1});case u.b.CONVERSATION_MESSAGE_LOADING:return Object(p.a)({},e,{messagesLoading:!0});case u.b.CONVERSATION_MESSAGE_LOADED_FAILED:return Object(p.a)({},e,{messagesLoading:!1});case u.b.CONVERSATION_MESSAGE_LOADED:return e.conversationId?Object(p.a)({},e,{messagesLoading:!1,lastTimestamp:s()(t.payload.messages,"0.timestamps")||e.lastTimestamp,hasMoreMessages:A()(t.payload.messages)>20,messageIds:k()(_()(t.payload.messages,"_id"),e.messageIds)}):e;case u.b.CONVERSATION_SELECTED:return Object(p.a)({},e,{conversationId:t.payload.conversation._id,conversationAssignedUUID:t.payload.conversation.conversationAssignedUUID||e.conversationAssignedUUID});case"CONVERSATION_CLEAR":return U;case u.e.MESSAGE_SENDING:return Object(p.a)({},e,{messagesBeingSent:[].concat(Object(g.a)(e.messagesBeingSent),[Object(p.a)({},t.payload,{status:"sending"})]),scrollAtBottom:!0,showScrollToBottom:!1});case"MESSAGE_SENT_FAILED":var n=t.payload.message;return Object(p.a)({},e,{messagesBeingSent:f()(e.messagesBeingSent,function(e){return e.clientAssignedUUID===n.clientAssignedUUID}),messagesFailed:[].concat(Object(g.a)(e.messagesFailed),[Object(p.a)({},n,{status:"failed"})])});case"RESEND_FAILED_MESSAGE":var a=t.payload.message;return Object(p.a)({},e,{messagesBeingSent:[].concat(Object(g.a)(e.messagesBeingSent),[Object(p.a)({},a,{status:"sending"})]),messagesFailed:f()(e.messagesFailed,function(e){return e.clientAssignedUUID===a.clientAssignedUUID})});case u.e.NEW_MESSAGE:var r=t.payload.message;return Object(p.a)({},e,{showScrollToBottom:!e.scrollAtBottom,adminIsTyping:"visitor"===s()(r,"author.type")&&e.adminIsTyping,messageIds:r.conversationId===e.conversationId?k()(e.messageIds,[r._id]):e.messageIds,messagesBeingSent:f()(e.messagesBeingSent,function(e){return e.clientAssignedUUID===r.clientAssignedUUID})});case"SCROLL_AT_BOTTOM_CHANGED":return Object(p.a)({},e,{scrollAtBottom:t.payload.scrollAtBottom,showScrollToBottom:!1});case u.c.CONVERSATION_ASSIGNED:return Object(p.a)({},e,{all:_()(e.all,function(e){return e._id===t.payload._id?t.payload.conversation:e}),conversation:e.conversation&&e.conversation._id===t.payload._id?t.payload.conversation:e.conversation});case u.c.NEW_CONVERSATION:var o=t.payload,i=o.conversation,c=o.messages;return e.conversationAssignedUUID!==i.conversationAssignedUUID?e:Object(p.a)({},e,{conversationId:i._id,messagesBeingSent:f()(e.messagesBeingSent,function(e){return!!w()(c,function(t){return e.clientAssignedUUID===t.clientAssignedUUID})||e.conversationAssignedUUID===i.conversationAssignedUUID||e.conversationId===i._id}),messageIds:c?_()(c,"_id"):e.messageIds});case u.f.UPDATE_SUCCESS:return Object(p.a)({},e,{messageIds:N()(e.messageIds,function(e){return e!==s()(t.payload,"context.formMessageId")})});case"RECEIVE_MESSAGE_FROM_PARENT_WINDOW":return Object(p.a)({},e,{messageFromParentWindow:t.payload.message});default:return e}},db:H.a.reducer,notification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_NOTIFICATION_MESSAGE":var n=s()(t,"payload.messages.0.conversationId");return n?Object(p.a)({},e,{unreadConversationIds:k()(e.unreadConversationIds,[n]),unreadMessageIds:k()(e.unreadMessageIds,_()(t.payload.messages,"_id"))}):e;case"REMOVE_NOTIFICATION":var a=t.payload.conversation._id,r=_()(t.payload.messages,"_id");return Object(p.a)({},e,{unreadConversationIds:f()(e.unreadConversationIds,function(e){return e===a}),unreadMessageIds:f()(e.unreadMessageIds,function(e){return B()(r,e)})});case u.e.MESSAGE_UNREAD_LOADED:return Object(p.a)({},e,{unreadConversationIds:_()(t.payload.conversations,"_id"),unreadMessageIds:_()(t.payload.messages,"_id")});case u.a.ASK_PERMISSION_SW:return Object(p.a)({},e,{askPermissionSw:!0});case u.a.CLOSE_ASK_PERMISSION_SW:return Object(p.a)({},e,{askPermissionSw:!1});default:return e}},faq:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{inputValue:"",isFAQSearchInputFocused:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.b.FAQ_VIEW_DETAIL_UNLOAD:return Object(p.a)({},e,{faq:null});case u.b.FAQ_VIEW_DETAIL:return Object(p.a)({},e,{faq:t.payload.faq});case u.b.FAQ_LIST_UNLOAD:return Object(p.a)({},e,{selected:null});case u.b.FAQ_CATEGORY_SELECTED:return Object(p.a)({},e,{selected:t.payload.category});case u.b.FAQ_SEARCH_INPUT_CHANGE:return Object(p.a)({},e,{inputValue:t.payload});case u.b.FAQ_SEARCH_INPUT_FOCUS:return Object(p.a)({},e,{isFAQSearchInputFocused:t.payload});case"VOTED_FAQS_LOADED":return Object(p.a)({},e,{voted:t.payload.voted});case"VOTED":return Object(p.a)({},e,{voted:_()(e.voted,function(e){return e.faq!==t.payload.faqId?e:Object(p.a)({},e,{action:t.payload.data})})});default:return e}},bot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{runningBots:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CUSTOM_BOT_STARTING":return Object(p.a)({},e,{startingBots:Object(p.a)({},e.startingBots,Object(M.a)({},t.payload.botId,!0))});case"CUSTOM_BOT_STARTED":return Object(p.a)({},e,{runningBots:Object(p.a)({},e.runningBots,Object(M.a)({},t.payload.runId,{conversationId:t.payload.conversationId,botId:t.payload.botId,pathId:t.payload.pathId,stepId:t.payload.stepId,completed:!1,isNew:!0})),startingBots:Object(p.a)({},e.startingBots,Object(M.a)({},t.payload.botId,!1)),hasTriggerEvent:!0});case"CUSTOM_BOT_CONVERSATION_UPDATED":var n=e.runningBots[t.payload.runId];return Object(p.a)({},e,{runningBots:Object(p.a)({},e.runningBots,Object(M.a)({},t.payload.runId,x()({},n,{conversationId:t.payload.conversationId,pathId:t.payload.pathId,stepId:t.payload.stepId,botId:t.payload.botId,isNew:!1})))});case"BOT_RUN_COMPLETED":var a=e.runningBots[t.payload.runId];return Object(p.a)({},e,{runningBots:Object(p.a)({},e.runningBots,Object(M.a)({},t.payload.runId,x()({},a,{completed:!0,isNew:!1})))});default:return e}},router:G.c,visualSelection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{canSave:!1,xpath:"",selected:"navigate"},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_XPATH":return Object(p.a)({},e,{canSave:!0,xpath:t.payload.xpath});case"SELECTED_BUTTON":return Object(p.a)({},e,{selected:t.payload.selected});default:return e}},parentDocument:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PARENT_IS_ACTIVE_UPDATE":return Object(p.a)({},e,{isParentActive:t.payload.isActive,lastParentActiveSince:t.payload.isActive?Date.now():e.lastParentActiveSince,lastParentInactiveSince:t.payload.isActive?e.lastParentInactiveSince:Date.now()});default:return e}}}),q=n(343),W=n.n(q);n.d(t,"a",function(){return Q}),n.d(t,"b",function(){return Y});var Q=W()(),z=Object(G.b)(Q),Y=Object(a.createStore)(V,Object(o.composeWithDevTools)(Object(a.applyMiddleware)(z,r.a,d,l)))},99:function(e,t,n){"use strict";var a=n(21),r=n.n(a),o=n(50),i=n(23),s=n.n(i),c=n(3),u=n.n(c),d=n(34),l=n.n(d),p=n(11),g=n.n(p),m=n(96),f=n.n(m),h=n(121),v=n.n(h),b=n(16),y=n.n(b),E=n(37),A=n(9),O=n(2),S=n(352),I=n.n(S),T=n(353),_=n.n(T),C=n(120),N=n.n(C),D=n(354),w=n.n(D),j=n(57),k=n.n(j),P=n(355),R=n.n(P),U=n(1),L=n(7);var B={processTriggerCampaigns:function(e){return function(t,n){var a=n(),r=U.a.getTable(a,U.a.tableNames.campaigns),o=U.a.query(r,{}),i={url:L.g.getLocation().url,elapsed:e};return R()(function(e){return function(e,t,n,a){L.c.isConditionSatisfied(Object(O.a)({},e.condition,{conditions:k()(w()(function(e){return Object(O.a)({},e,{attribute:e.triggerType})}),N()(function(e){return _()(e.triggerType,["presenceDuration","url"])}),I()("condition.conditions"))(e)}),a)&&(n(U.a.remove(U.a.tableNames.campaigns,e._id)),L.b.trigger(e))}(e,0,t,i)},o)}}},M=n(54),F=n(51);function x(){var e=A.b.getState();return function(e,t,n){t(M.a.processTriggerBot())||u()(e,"bot.hasTriggerEvent")||t(B.processTriggerCampaigns(n)),F.a.checkHoverDuration(),F.a.checkPoll()}(e,A.b.dispatch,Date.now()-e.common.widgetStartedAt)}var H={init:function(){setInterval(x,500)}},G=n(44);var V={registerInactiveDetection:function(){G.a.addEventListener({eventType:"mouseenter",targetType:"document"},function(e){A.b.dispatch({type:"PARENT_IS_ACTIVE_UPDATE",payload:{isActive:!0}})}),G.a.addEventListener({eventType:"mouseleave",targetType:"document"},function(e){A.b.dispatch({type:"PARENT_IS_ACTIVE_UPDATE",payload:{isActive:!1}})})}},q=n(4),W=n(77),Q={newMessage:function(e){A.b.dispatch({type:"NEW_NOTIFICATION_MESSAGE",payload:{messages:[e]}}),function(){if(!Y)return;try{z.src||(z.src="/sounds/newMessage.ogg");var e=z.play();e&&e.catch&&e.catch(function(){})}catch(t){}}()}},z=new Audio,Y=!1;document.body.addEventListener("click",function(){if(!Y){var e=z.play();e&&e.then&&e.then(function(){z.pause(),z.currentTime=0}),Y=!0}});var K=n(13);function X(e){var t=e.message;A.b.dispatch(U.a.write(U.a.tableNames.messages,t)),A.b.dispatch({type:q.e.NEW_MESSAGE,payload:{message:t}});var n=u()(t,"author.type");g()(e.conversationUpdates)||A.b.dispatch(U.a.update(U.a.tableNames.conversations,t.conversationId,e.conversationUpdates)),"visitor"!==n&&(!function(e){var t=A.b.getState();return"conversation"===t.common.currentPage&&t.conversation.conversationId===e.conversationId}(t)?Q.newMessage(t):A.b.dispatch(K.d.markAsRead(t.conversationId)))}var J={init:function(e,t){var n=W.a.initSocket(e,t);return n.on("error",alert),n.on("message",X),n.on("newConversation",function(e){var t=e.conversation,n=e.messages;A.b.dispatch(U.a.write(U.a.tableNames.messages,n)),A.b.dispatch(U.a.write(U.a.tableNames.conversations,t)),A.b.dispatch({type:q.c.NEW_CONVERSATION,payload:{conversation:t,messages:n}}),A.b.dispatch(K.d.markAsRead(t.conversationAssignedUUID)),A.b.dispatch(U.a.remove(U.a.tableNames.conversations,t.conversationAssignedUUID)),"object"===typeof t.lastMessage&&X({message:t.lastMessage})}),n.on("ConversationChangeStatus",function(e){A.b.dispatch(U.a.update(U.a.tableNames.conversations,e._id,{status:e.status}))}),n.on("ConversationAssigned",function(e){A.b.dispatch(U.a.update(U.a.tableNames.conversations,e.conversation._id,{assignedTo:u()(e,"conversation.assignedTo",null),assignedAt:u()(e,"conversation.assignedAt",null)}))}),n.on("BotRunCompleted",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A.b.dispatch({type:"BOT_RUN_COMPLETED",payload:e})}),n.on("BotIsTyping",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A.b.dispatch({type:"CONVERSATION_ADMIN_IS_TYPING",payload:{conversation:e.conversation}})}),n.on("BotStopsTyping",function(e){A.b.dispatch({type:"CONVERSATION_ADMIN_STOPS_TYPING",payload:{conversation:e.conversation}})}),n.on("botTransitionCompleted",function(e){if(!g()(e)&&!g()(e.result)){var t={runId:e.runId,pathId:u()(e,"result.nextPath.id"),stepId:u()(e,"result.nextStep.id"),conversationId:e.conversationId};A.b.dispatch({type:"CUSTOM_BOT_CONVERSATION_UPDATED",payload:t})}}),n.on("VISITOR_UPDATED",function(e){A.b.dispatch({type:"VISITOR_UPDATED",payload:e})}),n}},Z=n(43),$=n(6),ee=n(58),te=n(17),ne=n(42),ae=n.n(ne);n.d(t,"a",function(){return re});var re={init:function(){return function(e){var t=L.a.getToken(),n=function(e){try{var t=E.a.getItem("appToken.".concat(e,".app"));return t?JSON.parse(t):null}catch(n){return null}}(t);n&&e({type:q.b.APP_LOAD,payload:n});var a=L.g.getUserData(),i=L.g.getBotSimulationId(),s=L.i.isLoggedInUser(a);$.a.loadStoredUser(t);var c=$.a.getVisitorToken(t),d=L.g.getLocation(!0),p={locale:navigator.language,startedUrl:{url:d.url,name:d.title},referrer:d.referrer,deviceWebMeta:{browser:v.a.name,browserVersion:v.a.version,device:v.a.product||"Web",os:v.a.os.family,browserLanguage:ee.a.getBrowserLanguage()},alias:y()()},m=i?{createNewData:p,isSimulating:!0,referrerUrl:d.url}:f()({userData:s?a:null,createNewData:s||c?null:p,referrerUrl:d.url},g.a);return L.a.init(m).then(function(n){var a,s,c;g()(n.feedback)||Object(te.m)("oncustomer:feedback",{feedback:n.feedback,app:n.app,feedbackRoot:ae.a.FEEDBACK_ROOT_PATH}),L.i.saveVisitor(n.user),e({type:q.f.GET_INFO_USER,payload:n.user}),e({type:q.b.APP_LOAD,payload:n.app}),e(U.a.write(U.a.tableNames.conversations,n.conversations)),e(M.a.rehydrateBotProgress(n.conversations)),e(U.a.write(U.a.tableNames.messages,n.unreadMessages)),e(U.a.write(U.a.tableNames.customBots,n.bots)),e(U.a.write(U.a.tableNames.campaigns,n.campaigns)),e({type:q.e.MESSAGE_UNREAD_LOADED,payload:{conversations:l()(n.conversations,function(e){return e.unreadByUser}),messages:n.unreadMessages}}),e({type:"APP_INITIALIZED"}),L.i.getAllCustomFields().then(function(t){e(U.a.write(U.a.tableNames.customFields,t))}),J.init(n.app,{isNew:n.isNew}),V.registerInactiveDetection(),document.onkeydown=function(e){!e||"Escape"!==e.key&&"Esc"!==e.key&&27!==e.keyCode||Object(te.n)()},a=t,s=n.app,E.a.setItem("appToken.".concat(a,".app"),JSON.stringify(s)),e(M.a.setupSelectionBots()),setTimeout(Object(o.a)(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=7;break}return t.next=3,Z.a.getBotSimulation(i);case 3:(n=t.sent)&&(e({type:q.b.CUSTOM_BOT_SIMULATION_INIT}),e(U.a.write(U.a.tableNames.customBots,n)),e(M.a.startBot(n))),t.next=8;break;case 7:H.init();case 8:case"end":return t.stop()}},t)})),1e3),Object(te.m)("visitor:initialized",{id:u()(n.user,"_id")}),u()(n,"onPageDurationScoreSeconds")&&e((c=u()(n,"onPageDurationScoreSeconds"),function(e,t){setTimeout(function(){var e=t();L.i.finishOnPageScore(u()(e,"auth.visitor._id"))},1e3*c)}))}).catch(function(e){"not_in_whitelisted_domains"===u()(e,"response.body.message")&&Object(te.i)()})}},toggle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breadCrumbsUpdates,n=e.widgetOpen;return function(e,a){var r=a(),o=s()(n)?!r.common.widgetOpen:n;$.a.waitForApp(function(){r.common.mainLoaded||r.common.mainLoading||(e({type:"APP_MAIN_DATA_LOADING"}),L.a.getMainData().then(function(t){e(U.a.write(U.a.tableNames.agents,t.agents)),e(U.a.write(U.a.tableNames.faqCategories,t.faqCategories)),e({type:"APP_MAIN_DATA_LOADED"})}));var a=u()(r,"common.app.widgetConfig.size","large");return Object(te.d)(o?"show":"hide",{widgetSize:a}),e({type:"WIDGET_TOGGLED",payload:{breadCrumbsUpdates:t,widgetOpen:n}})})}},started:function(){return{type:"WIDGET_STARTED"}}}}},[[383,11,9]]]);